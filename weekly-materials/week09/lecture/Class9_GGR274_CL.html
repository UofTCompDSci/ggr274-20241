
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Class 9 &#8212; Computation and Data Science for Social Sciences</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'weekly-materials/week09/lecture/Class9_GGR274_CL';</script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="GGR274 Lab 9: Project proposal feedback, data pre-processing" href="../lab/Lab_9.html" />
    <link rel="prev" title="GG274 Homework 8: Hypothesis Testing" href="../../week08/homework/Homework_8.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../jupyter-book/index.html">
  
  
  
  
  
  
    <p class="title logo__title">Computation and Data Science for Social Sciences</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../jupyter-book/index.html">
                    👋 Course Website for GGR274H1-S Winter 2024
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Quick Links</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../syllabus/ggr274_syllabus.html">Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference external" href="https://q.utoronto.ca/courses/338580/announcements">Announcements</a></li>
<li class="toctree-l1"><a class="reference external" href="https://piazza.com/utoronto.ca/winter2024/ggr274h1">Piazza</a></li>
<li class="toctree-l1"><a class="reference external" href="https://forms.office.com/Pages/ResponsePage.aspx?id=JsKqeAMvTUuQN7RtVsVSEF-wqptfr85NieT8UyliaxxUOUtMSVFUQkFTNVdRTlVJNkZFQU84NldYUi4u">Course Feedback Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../guides/jupyterhub_guide.html">JupyterHub Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/markus_guide.html">MarkUs Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://q.utoronto.ca/courses/338580/files?preview=29750629">Prof. Li's Slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/lecture/Class1_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/lecture/Class1_GGR274_IM.html">Prof. Musabirov's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/lab/Lab_1.html">Lab 01 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/lab/Lab_1_solutions.html">Lab 01 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/homework/Homework_1.html">Homework 01 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/homework/Homework_1_solution.html">Homework 01 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week02/lecture/Class2_GGR274_DL_IM.html">Prof. Musabirov's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/lab/Lab_2.html">Lab 02 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/lab/Lab_2_solutions.html">Lab 02 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/homework/Homework_2.html">Homework 02 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/homework/Homework_2_solution.html">Homework 02 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week03/lecture/Class3_GGR274_DL_IM.html">Prof. Musabirov's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/lab/Lab_3.html">Lab 03 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/lab/Lab_3_solutions.html">Lab 03 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/homework/Homework_3.html">Homework 03 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/homework/Homework_3_solution.html">Homework 03 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://q.utoronto.ca/courses/338580/files?preview=30071956">Prof. Li's Slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/lecture/Class4_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/lab/Lab_4.html">Lab 04 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/lab/Lab_4_solutions.html">Lab 04 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/homework/Homework_4.html">Homework 04 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/homework/marking/Homework_4_solution.html">Homework 04 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week05/lecture/Class5_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/lab/Lab_5.html">Lab 05 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/lab/Lab_5_solutions.html">Lab 05 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/homework/Homework_5.html">Homework 05 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/homework/marking/Homework_5_solution.html">Homework 05 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice Midterm</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../practice/sample_midterm/GGR274_Midterm.html">2022 Midterm Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../practice/review_w1-3.html">Review of frequent errors and extra examples for weeks 1-3</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Midterm</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../tests/midterm/Midterm.html">Midterm Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tests/midterm-makeup/Midterm_makeup.html">Midterm (makeup) Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../project/proposal/GGR274_Project_Proposal.html">Project Proposal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../project/presentation/GGR274_Final_Project_Instruction.html">Final Project Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../project/presentation/extras/GGR274DSconfslides.html">Final Project Presentation Slides Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../project/presentation/extras/Tipsandtricksforslides.html">Additional Tips and Tricks for Creating Slides in a Jupyter Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://q.utoronto.ca/courses/338580/files?preview=30627394">Prof. Li's Slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/lecture/Class7_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/lab/Lab_7.html">Lab 07 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/lab/Lab_7_solutions.html">Lab 07 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/homework/Homework_7.html">Homework 07 Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week08/lecture/Class8_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/lab/Lab_8.html">Lab 08 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/homework/Homework_8.html">Homework 08 Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Class 9</a></li>





<li class="toctree-l1"><a class="reference internal" href="../lab/Lab_9.html">Lab 09 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/Homework_9.html">Homework 09 Notebook</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyter.utoronto.ca/hub/user-redirect/git-pull?repo=https%3A//github.com/UofTCompDSci/ggr274-20241&urlpath=tree/ggr274-20241/weekly-materials/week09/lecture/Class9_GGR274_CL.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/weekly-materials/week09/lecture/Class9_GGR274_CL.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Class 9</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Class 9</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mar-12-2024">Mar. 12, 2024</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrangment-of-the-last-3-tutorials">Arrangment of the last 3 tutorials</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-start-with-a-story">Bootstrap - start with a story</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-this-a-good-idea">Why is this a good idea?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampled-mean">Resampled mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boostrap-confidence-intervals-cis">Boostrap confidence intervals (CIs)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bootstrap-confidence-intervals-to-compare-samples">Using Bootstrap confidence intervals to compare samples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-people-with-no-children-under-14-spend-more-time-resting">Do people with no children under 14 spend more time resting?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing">Hypothesis testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-exercise">In-class exercise</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#another-method-to-compare-two-samples-a-review-of-shuffling">Another method to compare two samples (A review of shuffling)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-thought-expriement-shuffling-process">A thought expriement: shuffling process</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-shuffling-the-children-label-and-assignment-to-the-samples">Step 1: shuffling the children label and assignment to the samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-compute-the-mean-resting-time-difference-between-people-with-and-without-children">Step 2: compute the mean resting time difference between people with and without children</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-repeat-steps-1-and-2-a-large-number-of-times-e-g-5000-to-get-the-distribution-of-mean-differences">Step 3: Repeat Steps 1 and 2 a large number of times (e.g., 5000) to get the distribution of mean differences.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compare-the-simulate-mean-differences-to-the-observed-mean-difference-and-calculate-p-value">Step 4: Compare the simulate mean differences to the observed mean difference and calculate p-value</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-interpretation">Step 5: Interpretation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#think-about">Think about:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-difference-between-bootstrap-and-shuffling">what is the difference between bootstrap and shuffling?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-idea">Basic idea</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-perfect-linear-relationship-between-dependent-and-independent-variables">Example 1: perfect linear relationship between dependent and independent variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-data">Plot the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-regression-line">Compute the regression line</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-another-perfect-linear-relationship">Example 2: another perfect linear relationship</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-y-intercept">Interpretation of y-intercept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-slope">Interpretation of slope</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-close-to-linear">Example 3: close to linear</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-summary-of-linear-regression">Statistical summary of linear regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predicted-values-and-residuals">Predicted values and residuals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-of-linear-regression">Accuracy of linear regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4-regression-with-two-or-more-independent-variables">Example 4: regression with two or more independent variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-summary-of-a-multiple-regression-model">Statistical summary of a multiple regression model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-of-multiple-regression-model">Accuracy of multiple regression model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-effect-of-recent-immigration-on-asthma-rates-in-toronto-neighbourhoods">What is the effect of recent immigration on asthma rates in Toronto neighbourhoods?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sociodemographic-data">Sociodemographic data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#asthma-data">Asthma data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-sociodemographic-and-asthma-data">Merge Sociodemographic and asthma data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-regression-model-of-asthma-on-immigration">A regression model of asthma on immigration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Plot the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-the-regression-model">Fit the regression model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-summary-of-the-regression-model">Statistical summary of the regression model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-regression-model-is-the-equation">The regression model is the equation:</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-of-the-regression-model">Accuracy of the regression model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-and-testing-a-model">Training and testing a model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#splitting-a-pandas-dataframe-by-index">Splitting a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by <code class="docutils literal notranslate"><span class="pre">index</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-training-and-test-data-sets-from-a-single-dataset">Creating training and test data sets from a single dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1">Step 1:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-fit-the-regression-model-on-the-training-data">Step 2: Fit the regression model on the training data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-compute-predicted-fitted-values-using-training-data">Step 3: Compute predicted (fitted) values using training data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-evaluate-accuracy-using-root-mean-squared-error-on-training-data">Step 4: Evaluate accuracy using root mean-squared error on training data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-evaluate-the-accuracy-of-regression-model-on-the-test-data-using-root-mean-squared-error">Step 5: Evaluate the accuracy of regression model on the test data using root mean-squared error</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-of-data-analysis-using-linear-regression-model">Conclusion of data analysis using linear regression model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#are-there-other-sociaodemographic-factors-in-our-data-that-might-effect-asthma-rates">Are there other sociaodemographic  factors in our data that might effect asthma rates?</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="class-9">
<h1>Class 9<a class="headerlink" href="#class-9" title="Link to this heading">#</a></h1>
<section id="mar-12-2024">
<h2>Mar. 12, 2024<a class="headerlink" href="#mar-12-2024" title="Link to this heading">#</a></h2>
<p>By the end of this class, you’ll be able to:</p>
<ul class="simple">
<li><p>Obtain bootstrap confidence intervals;</p></li>
<li><p>Compare two samples using shuffling and bootstrapped resampling;</p></li>
<li><p>Learn linear regression</p></li>
</ul>
</section>
<section id="arrangment-of-the-last-3-tutorials">
<h2>Arrangment of the last 3 tutorials<a class="headerlink" href="#arrangment-of-the-last-3-tutorials" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>You will think about and start to do your course projects in tutorials.</p></li>
<li><p>Take the chance to discuss with your colleagues and TA!</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bootstrap-start-with-a-story">
<h1>Bootstrap - start with a story<a class="headerlink" href="#bootstrap-start-with-a-story" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>A data scientist is using the data in a random sample to estimate an unknown statistical parameter such as the mean time spent resting. She uses the sample to calculate the value of a statistic that she will use as her estimate.</p></li>
</ul>
<ul class="simple">
<li><p>Once she has calculated the observed value of her statistic, she could just present it as her estimate and go on her merry way. But she’s a data scientist. She knows that her random sample is just one of numerous possible random samples, and thus her estimate is just one of numerous plausible estimates.</p></li>
</ul>
<ul class="simple">
<li><p>By how much could those estimates vary? To answer this, it appears as though she needs to draw another sample from the population, and compute a new estimate based on the new sample. But she doesn’t have the resources to go back to the population and draw another sample.</p></li>
</ul>
<ul class="simple">
<li><p>It looks as though the data scientist is stuck.</p></li>
</ul>
<ul class="simple">
<li><p>Fortunately, a brilliant idea called the bootstrap can help her out. Since it is not feasible to generate new samples from the population, the bootstrap generates new random samples by a method called resampling: the new samples are drawn at random from the original sample.</p></li>
</ul>
<ul class="simple">
<li><p>We observed before that a large random sample from a population resembles the population from which it was drawn.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>


<span class="n">time_use_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;gss_tu2016_main_file.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dur01</span>              <span class="n">Duration</span> <span class="o">-</span> <span class="n">Sleeping</span><span class="p">,</span> <span class="n">resting</span><span class="p">,</span> <span class="n">relaxing</span><span class="p">,</span> <span class="n">sick</span> <span class="ow">in</span> <span class="n">bed</span>

           <span class="n">VALUE</span>  <span class="n">LABEL</span>
               <span class="mi">0</span>  <span class="n">No</span> <span class="n">time</span> <span class="n">spent</span> <span class="n">doing</span> <span class="n">this</span> <span class="n">activity</span>
            <span class="mi">9996</span>  <span class="n">Valid</span> <span class="n">skip</span>
            <span class="mi">9997</span>  <span class="n">Don</span><span class="s1">&#39;t know</span>
            <span class="mi">9998</span>  <span class="n">Refusal</span>
            <span class="mi">9999</span>  <span class="n">Not</span> <span class="n">stated</span>

           <span class="n">Data</span> <span class="nb">type</span><span class="p">:</span> <span class="n">numeric</span>
           <span class="n">Missing</span><span class="o">-</span><span class="n">data</span> <span class="n">codes</span><span class="p">:</span> <span class="mi">9996</span><span class="o">-</span><span class="mi">9999</span>
           <span class="n">Record</span><span class="o">/</span><span class="n">columns</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mi">65</span><span class="o">-</span><span class="mi">68</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_use_df</span><span class="p">[</span><span class="s1">&#39;dur01&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a50174361fbdb97f5918515f80f35e6fd5422540b24e1f90829b0fdbe9dc746c.png" src="../../../_images/a50174361fbdb97f5918515f80f35e6fd5422540b24e1f90829b0fdbe9dc746c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">time_use_df</span><span class="p">[</span><span class="s1">&#39;dur01&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_use_df</span><span class="p">[</span><span class="s1">&#39;dur01&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>510.0
522.3930994824611
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Draw a random sample <em><strong>with replacement</strong></em> of the same size (number of rows) as the original sample.</p></li>
<li><p>This opens the possibility for the new sample to be different from the original sample.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sleep_bs_sample</span> <span class="o">=</span> <span class="n">time_use_df</span><span class="p">[</span><span class="s1">&#39;dur01&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">sleep_bs_sample</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sleep_bs_sample</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sleep_bs_sample</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>510.0
520.5645773433007
</pre></div>
</div>
<img alt="../../../_images/867a07fe617234c0fa14b14204616ac356f356002c1e4910c41298d2c239565e.png" src="../../../_images/867a07fe617234c0fa14b14204616ac356f356002c1e4910c41298d2c239565e.png" />
</div>
</div>
<section id="why-is-this-a-good-idea">
<h2>Why is this a good idea?<a class="headerlink" href="#why-is-this-a-good-idea" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>By the law of averages, if we have many resamples, the distribution of all the resamples should close to the distribution of the “true” distribution (i.e., the population distribution)</p></li>
<li><p>Make it clear: by bootstrap, we can obtain a distribution of certain statstics (e.g., mean), instead of a single value</p></li>
</ul>
</section>
<section id="resampled-mean">
<h2>Resampled mean<a class="headerlink" href="#resampled-mean" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>We generated one resampled or <em>bootstrapped</em> mean above.</p></li>
<li><p>By resampling many times we can compute the empirical distribution of the mean sleep time.</p></li>
<li><p>The distribution of the boostrapped means should contain the population mean.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">one_bs_mean</span><span class="p">():</span>
    <span class="n">mean_bsample</span> <span class="o">=</span> <span class="n">time_use_df</span><span class="p">[</span><span class="s1">&#39;dur01&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">mean_bsample</span>

<span class="n">one_bs_mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>522.7950546290972
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Now let’s compute many resampled mean by writing a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bootstrap_means</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># empty list to collect means</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">bootstrap_means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">one_bs_mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bootstrap_means</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/3e63289b0a6c7557869bf4be067243845406efd6c990520ca0d6d0c7af9c9455.png" src="../../../_images/3e63289b0a6c7557869bf4be067243845406efd6c990520ca0d6d0c7af9c9455.png" />
</div>
</div>
</section>
<section id="boostrap-confidence-intervals-cis">
<h2>Boostrap confidence intervals (CIs)<a class="headerlink" href="#boostrap-confidence-intervals-cis" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>We can use the bootstrap distribution to construct a range of values such that 95% of the random samples will contain the true mean (i.e., population mean).</p></li>
<li><p>The range of values is called a confidence interval.</p></li>
<li><p>A 95% confidence interval for the mean can be constructed finding the 2.5% percentile and the 97.5% percentile.</p></li>
<li><p>The reason for choosing 2.5% and 97.5% is that 0.05/2 = 0.025, and 1 - 0.025 = 0.975.</p></li>
<li><p>We can do this using the <code class="docutils literal notranslate"><span class="pre">percentile</span></code> function in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootstrap_means</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">high_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootstrap_means</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A 95% bootstrap confidence interval for mean is </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">low_range</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> minutes to </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">high_range</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> minutes.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A 95% bootstrap confidence interval for mean is 520.44 minutes to 524.4 minutes.
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-bootstrap-confidence-intervals-to-compare-samples">
<h2>Using Bootstrap confidence intervals to compare samples<a class="headerlink" href="#using-bootstrap-confidence-intervals-to-compare-samples" title="Link to this heading">#</a></h2>
<section id="do-people-with-no-children-under-14-spend-more-time-resting">
<h3>Do people with no children under 14 spend more time resting?<a class="headerlink" href="#do-people-with-no-children-under-14-spend-more-time-resting" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Let’s create a dataset (<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>) with children under 14 and time spent resting.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chh0014c</span>           <span class="n">Child</span><span class="p">(</span><span class="n">ren</span><span class="p">)</span> <span class="ow">in</span> <span class="n">household</span> <span class="o">-</span> <span class="mi">0</span> <span class="n">to</span> <span class="mi">14</span> <span class="n">years</span>

           <span class="n">VALUE</span>  <span class="n">LABEL</span>
               <span class="mi">0</span>  <span class="kc">None</span>
               <span class="mi">1</span>  <span class="n">One</span>
               <span class="mi">2</span>  <span class="n">Two</span>
               <span class="mi">3</span>  <span class="n">Three</span> <span class="ow">or</span> <span class="n">more</span>
               <span class="mi">6</span>  <span class="n">Valid</span> <span class="n">skip</span>
               <span class="mi">7</span>  <span class="n">Don</span><span class="s1">&#39;t know</span>
               <span class="mi">8</span>  <span class="n">Refusal</span>
               <span class="mi">9</span>  <span class="n">Not</span> <span class="n">stated</span>

</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dur01&#39;</span><span class="p">,</span> <span class="s1">&#39;chh0014c&#39;</span><span class="p">]</span>

<span class="n">colnames</span> <span class="o">=</span> <span class="p">{</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;resttime&#39;</span><span class="p">,</span>
            <span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;children&#39;</span><span class="p">}</span>

<span class="n">restchild_df</span> <span class="o">=</span> <span class="n">time_use_df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

<span class="n">restchild_df</span> <span class="o">=</span> <span class="n">restchild_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">restchild_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">restchild_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>resttime</th>
      <th>children</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>510</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>420</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>570</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>510</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>525</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hypothesis-testing">
<h3>Hypothesis testing<a class="headerlink" href="#hypothesis-testing" title="Link to this heading">#</a></h3>
<p>Two claims:</p>
<ol class="arabic simple">
<li><p>Null hypothesis: There is no difference in the average resting time between people with and without children under 14.</p></li>
<li><p>Alternative hypothesis: There is difference in the average resting time between people with and without children under 14.</p></li>
</ol>
<ul class="simple">
<li><p>2a. Alternative hypothesis: People with children with children under 14 have less resting time than the people with no children under 14.</p></li>
</ul>
<p>Create a new column <code class="docutils literal notranslate"><span class="pre">'Child_in_house'</span></code> that indicates if a child is in the house.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">restchild_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">restchild_df</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Child_in_house&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Yes&#39;</span>

<span class="n">restchild_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">restchild_df</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Child_in_house&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;No&#39;</span>

<span class="n">restchild_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>resttime</th>
      <th>children</th>
      <th>Child_in_house</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>510</td>
      <td>0</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>420</td>
      <td>0</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>570</td>
      <td>3</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>510</td>
      <td>0</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>525</td>
      <td>0</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_rest_times</span> <span class="o">=</span> <span class="n">restchild_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Child_in_house&#39;</span><span class="p">)[</span><span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mean_rest_times</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean difference:&#39;</span><span class="p">,</span> <span class="n">mean_rest_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_rest_times</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Child_in_house
No     525.826128
Yes    509.046936
Name: resttime, dtype: float64
Mean difference: 16.77919133837969
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">restchild_df</span><span class="p">[[</span><span class="s1">&#39;Child_in_house&#39;</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;Child_in_house&#39;</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/bddee6e933cf3697f7c432ac3263f8d90ff2049b5c365ab5bc068646968618c4.png" src="../../../_images/bddee6e933cf3697f7c432ac3263f8d90ff2049b5c365ab5bc068646968618c4.png" />
</div>
</div>
<p>Create a function to create one bootstrap sample of the mean difference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">child</span> <span class="o">=</span> <span class="n">restchild_df</span><span class="p">[</span><span class="s1">&#39;Child_in_house&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span>

<span class="n">nochild</span> <span class="o">=</span> <span class="n">restchild_df</span><span class="p">[</span><span class="s1">&#39;Child_in_house&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span>

<span class="k">def</span> <span class="nf">bs_one_mean_diff</span><span class="p">():</span>
    <span class="c1"># sample sleep and rest with replacement</span>
    <span class="n">bssample</span> <span class="o">=</span> <span class="n">restchild_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span>  <span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># compute difference in means on bootstrap sample</span>
    <span class="n">bs_mean_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">bssample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nochild</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> 
                   <span class="n">bssample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">child</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">bs_mean_diff</span>

<span class="n">bs_one_mean_diff</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.183843323805775
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Compute bootstrap distribution.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bootst_mean_diffs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">bootst_mean_diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs_one_mean_diff</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/9b910f9dae424b758f702c1e88dbec9a3c01321545f6aa25b24fc573f691feac.png" src="../../../_images/9b910f9dae424b758f702c1e88dbec9a3c01321545f6aa25b24fc573f691feac.png" />
</div>
</div>
<p>A 95% confidence interval for the mean difference is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(12.076536619242049, 21.439307929666562)
</pre></div>
</div>
</div>
</div>
<p>The confidence interval does not contain 0 and larger than 0.</p>
<ul class="simple">
<li><p>The null hypothesis is rejected; the alternative hypothesis is accepted (in 95% CI).</p></li>
<li><p>The people without children have significantly more resting time than the people with children in 95% CI.</p></li>
</ul>
</section>
</section>
<section id="in-class-exercise">
<h2>In-class exercise<a class="headerlink" href="#in-class-exercise" title="Link to this heading">#</a></h2>
<p>Modify the code above to compute a 95% bootstrap confidence interval for the difference in 90th percentiles between respondents with and without children under 14.  Does the confidence interval contain 0?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(12.748715742641815, 20.7058104123397)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># 95% confidence intervel in red line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;axvline - full height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;axvline - full height&#39;</span><span class="p">)</span>
<span class="c1"># 90% confidence intervel in blue line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;axvline - full height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootst_mean_diffs</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;axvline - full height&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/f713fced3169c171f90270aa940ec3b4859ae742a00ebfc4a341d86b196110a8.png" src="../../../_images/f713fced3169c171f90270aa940ec3b4859ae742a00ebfc4a341d86b196110a8.png" />
</div>
</div>
<p>Larger confidence interval (95% v.s. 90%) mean wider distribution</p>
<ul class="simple">
<li><p>Less likely (5% v.s. 10%) to be wrong to reject the null hypothesis</p></li>
</ul>
<section id="another-method-to-compare-two-samples-a-review-of-shuffling">
<h3>Another method to compare two samples (A review of shuffling)<a class="headerlink" href="#another-method-to-compare-two-samples-a-review-of-shuffling" title="Link to this heading">#</a></h3>
</section>
<section id="id1">
<h3>Hypothesis testing<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Two claims:</p>
<ol class="arabic simple">
<li><p>Null hypothesis: The average resting time of people with children is the same as the average resting time of people without children.</p></li>
<li><p>Alternative hypothesis: The average resting time of people with children is different from the average resting time of people without children.</p></li>
</ol>
<ul class="simple">
<li><p>2a. Alternative hypothesis: People with children with children under 14 have less resting time than the people with no children under 14.</p></li>
</ul>
<section id="a-thought-expriement-shuffling-process">
<h4>A thought expriement: shuffling process<a class="headerlink" href="#a-thought-expriement-shuffling-process" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Imagine we have <code class="docutils literal notranslate"><span class="pre">len(restchild_df.loc[child])</span></code> cards labelled <code class="docutils literal notranslate"><span class="pre">Child</span></code> and <code class="docutils literal notranslate"><span class="pre">len(restchild_df.loc[nochild])</span></code> cards labelled <code class="docutils literal notranslate"><span class="pre">No_child</span></code>.</p></li>
<li><p>Shuffle the cards …</p></li>
<li><p>Assign the cards to the samples then calculate the mean resting time difference between <code class="docutils literal notranslate"><span class="pre">Child</span></code> and <code class="docutils literal notranslate"><span class="pre">No_child</span></code>.  This is one simulated value of the test statistic.</p></li>
<li><p>Shuffle the cards again …</p></li>
<li><p>Assign the cards to the samples then calculate the mean resting time difference between <code class="docutils literal notranslate"><span class="pre">Child</span></code> and <code class="docutils literal notranslate"><span class="pre">No_child</span></code>. This is second simulated value of the test statistic.</p></li>
<li><p>Continue shuffling, assigning , and computing the mean difference… in many times</p></li>
</ul>
<p>If there is no differences of the average rest time between people with or without children (null hypothesis), the shuffling process will change the mean difference. In other words, we will observe many ‘unusual’ mean differences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">restchild_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>resttime</th>
      <th>children</th>
      <th>Child_in_house</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>510</td>
      <td>0</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>420</td>
      <td>0</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>570</td>
      <td>3</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>510</td>
      <td>0</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>525</td>
      <td>0</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="step-1-shuffling-the-children-label-and-assignment-to-the-samples">
<h4>Step 1: shuffling the children label and assignment to the samples<a class="headerlink" href="#step-1-shuffling-the-children-label-and-assignment-to-the-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shuffle_df</span> <span class="o">=</span> <span class="n">restchild_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">restchild_sim</span> <span class="o">=</span> <span class="n">shuffle_df</span><span class="p">[</span><span class="s1">&#39;Child_in_house&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">restchild_sim</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     No
1     No
2     No
3    Yes
4     No
Name: Child_in_house, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-compute-the-mean-resting-time-difference-between-people-with-and-without-children">
<h4>Step 2: compute the mean resting time difference between people with and without children<a class="headerlink" href="#step-2-compute-the-mean-resting-time-difference-between-people-with-and-without-children" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_child</span> <span class="o">=</span> <span class="n">shuffle_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">restchild_sim</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_nochild</span> <span class="o">=</span> <span class="n">shuffle_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">restchild_sim</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">sim_diff</span> <span class="o">=</span> <span class="n">mean_nochild</span> <span class="o">-</span> <span class="n">mean_child</span>
<span class="n">sim_diff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.6287392010965505
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-repeat-steps-1-and-2-a-large-number-of-times-e-g-5000-to-get-the-distribution-of-mean-differences">
<h4>Step 3: Repeat Steps 1 and 2 a large number of times (e.g., 5000) to get the distribution of mean differences.<a class="headerlink" href="#step-3-repeat-steps-1-and-2-a-large-number-of-times-e-g-5000-to-get-the-distribution-of-mean-differences" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulated_diffs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">restchild_sim</span> <span class="o">=</span> <span class="n">shuffle_df</span><span class="p">[</span><span class="s1">&#39;Child_in_house&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">mean_child</span> <span class="o">=</span> <span class="n">shuffle_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">restchild_sim</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">mean_nochild</span> <span class="o">=</span> <span class="n">shuffle_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">restchild_sim</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">sim_diff</span> <span class="o">=</span> <span class="n">mean_nochild</span> <span class="o">-</span> <span class="n">mean_child</span>
    <span class="n">simulated_diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sim_diff</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">simulated_diffs</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;lightgrey&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a1d55707b7d61bd3f49f81ea0311e773f4b127011a3171051d36fe9f038bb342.png" src="../../../_images/a1d55707b7d61bd3f49f81ea0311e773f4b127011a3171051d36fe9f038bb342.png" />
</div>
</div>
</section>
<section id="step-4-compare-the-simulate-mean-differences-to-the-observed-mean-difference-and-calculate-p-value">
<h4>Step 4: Compare the simulate mean differences to the observed mean difference and calculate p-value<a class="headerlink" href="#step-4-compare-the-simulate-mean-differences-to-the-observed-mean-difference-and-calculate-p-value" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_mean_nochild</span> <span class="o">=</span> <span class="n">restchild_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">restchild_df</span><span class="p">[</span><span class="s1">&#39;Child_in_house&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">obs_mean_child</span> <span class="o">=</span> <span class="n">restchild_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">restchild_df</span><span class="p">[</span><span class="s1">&#39;Child_in_house&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;resttime&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">obs_diff</span> <span class="o">=</span> <span class="n">obs_mean_nochild</span> <span class="o">-</span> <span class="n">obs_mean_child</span>
<span class="n">obs_diff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.77919133837969
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulated_diffs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;sim_diffs&#39;</span> <span class="p">:</span> <span class="n">simulated_diffs</span><span class="p">})</span>

<span class="n">numgreater</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_diffs_df</span><span class="p">[</span><span class="s1">&#39;sim_diffs&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">obs_diff</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of simulated differences greater than the observed difference is:&#39;</span><span class="p">,</span> <span class="n">numgreater</span><span class="p">)</span>

<span class="n">numsmaller</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_diffs_df</span><span class="p">[</span><span class="s1">&#39;sim_diffs&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">obs_diff</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The number of simulated differences smaller than the observed difference is:&#39;</span><span class="p">,</span> <span class="n">numsmaller</span><span class="p">)</span>

<span class="n">pvalue</span> <span class="o">=</span> <span class="p">(</span><span class="n">numgreater</span> <span class="o">+</span> <span class="n">numsmaller</span><span class="p">)</span><span class="o">/</span> <span class="mi">5000</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The p-value is:&#39;</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The number of simulated differences greater than the observed difference is: 0
The number of simulated differences smaller than the observed difference is: 0
The p-value is: 0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-interpretation">
<h4>Step 5: Interpretation<a class="headerlink" href="#step-5-interpretation" title="Link to this heading">#</a></h4>
<p>None of the simulated differences is greater or smaller than the observed differences.</p>
<ul class="simple">
<li><p>The null hypothesis is rejected.</p></li>
</ul>
<p>The observed differences of resting time between people with and without children are true difference (instead of random error).</p>
<ul class="simple">
<li><p>obs_diff &gt; 0, indicating people without children have more restting time.</p></li>
</ul>
</section>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="think-about">
<h1>Think about:<a class="headerlink" href="#think-about" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="what-is-the-difference-between-bootstrap-and-shuffling">
<h1>what is the difference between bootstrap and shuffling?<a class="headerlink" href="#what-is-the-difference-between-bootstrap-and-shuffling" title="Link to this heading">#</a></h1>
<ol class="arabic simple">
<li><p>Both bootstrap and shuffling can be applied to compare two samples, but their logics are different.</p></li>
</ol>
<ul class="simple">
<li><p>Bootstrap: resampling <strong>with displacement</strong> and get the distribution of mean differences, which represents the mean differences in population</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">bssample</span> <span class="pre">=</span> <span class="pre">restchild_df.sample(frac</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">replace</span> <span class="pre">=</span>&#160; <span class="pre">True)</span></code></p>
<ul class="simple">
<li><p>Shuffling: shuffle the label (reampling <strong>without displacement</strong>) and reassign to the samples to get the distribution of mean differences, which represents the “unusual” values</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">restchild_sim</span> <span class="pre">=</span> <span class="pre">shuffle_df['Child_in_house'].sample(frac=1,</span> <span class="pre">replace</span> <span class="pre">=</span> <span class="pre">False).reset_index(drop</span> <span class="pre">=</span> <span class="pre">True)</span> </code></p>
<ol class="arabic simple" start="2">
<li><p>Bootstrap can be applied to many other situations in order to obtain robust results (e.g., regression), while shuffling can only applied in comparison between samples.</p></li>
</ol>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="linear-regression">
<h1>Linear Regression<a class="headerlink" href="#linear-regression" title="Link to this heading">#</a></h1>
<section id="basic-idea">
<h2>Basic idea<a class="headerlink" href="#basic-idea" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Linear regression is a useful technique for creating models to explain (linear) relationships between variables.</p></li>
<li><p>For use in multiple regression variables the dependent variable must be numeric, and have meaningful numeric values (i.e., must be an interval variable).</p></li>
<li><p>The independent variables can be categorical or interval variables.</p></li>
</ul>
</section>
<section id="example-1-perfect-linear-relationship-between-dependent-and-independent-variables">
<h2>Example 1: perfect linear relationship between dependent and independent variables<a class="headerlink" href="#example-1-perfect-linear-relationship-between-dependent-and-independent-variables" title="Link to this heading">#</a></h2>
<section id="data">
<h3>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;depvar&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">),</span>
       <span class="s1">&#39;indvar&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">)}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>depvar</th>
      <th>indvar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="plot-the-data">
<h3>Plot the data<a class="headerlink" href="#plot-the-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;indvar&#39;</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;depvar&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;indvar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;depvar&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/4ed382cc666aa1eb875a4adb63376e1208e29a58a2cc510879ba197a5f080812.png" src="../../../_images/4ed382cc666aa1eb875a4adb63376e1208e29a58a2cc510879ba197a5f080812.png" />
</div>
</div>
<ul class="simple">
<li><p>The scatter plot shows each pair of points (1, 1), (2, 2), etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'indvar'</span></code> is sometimes called a predictor variable or covariate, and <code class="docutils literal notranslate"><span class="pre">'depvar'</span></code> is called the dependent variable.</p></li>
<li><p>The dependent variable is predicted exactly by the independent variable.</p></li>
</ul>
</section>
<section id="compute-the-regression-line">
<h3>Compute the regression line<a class="headerlink" href="#compute-the-regression-line" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>

<span class="n">regmod</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;depvar ~ indvar&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span> <span class="c1"># setup the model</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The code above uses the <code class="docutils literal notranslate"><span class="pre">ols</span></code> function from <a class="reference external" href="https://www.statsmodels.org/stable/api.html#statsmodels-formula-api"><code class="docutils literal notranslate"><span class="pre">statsmodels.formula.api</span></code></a></p></li>
<li><p>The syntax in the function <code class="docutils literal notranslate"><span class="pre">ols</span></code> function <code class="docutils literal notranslate"><span class="pre">'depvar</span> <span class="pre">~</span> <span class="pre">indvar'</span></code> is a special syntax for describing statistical models.</p></li>
<li><p>The column name to the <strong>left</strong> of <code class="docutils literal notranslate"><span class="pre">~</span></code> specifies the dependent variable.</p></li>
<li><p>The column name to the <strong>right</strong> of <code class="docutils literal notranslate"><span class="pre">~</span></code> specifies the independent variable(s).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span> <span class="o">=</span> <span class="n">regmod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># estimate/fit the model </span>
</pre></div>
</div>
</div>
</div>
<p>After the model is setup then the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function can be applied to the model.  This function computes the equation of the regression line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">params</span> <span class="c1"># get parameter estimates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    5.551115e-16
indvar       1.000000e+00
dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The estimates of the <strong>y-intercept</strong> and <strong>slope</strong> are labelled <code class="docutils literal notranslate"><span class="pre">Intercept</span></code> (1.11e-16 approx 0)  and <code class="docutils literal notranslate"><span class="pre">indvar</span></code> (1.00e+00 approx 1).</p></li>
<li><p>This means the regression equation is: $<span class="math notranslate nohighlight">\(\texttt{depvar} = 0 + 1 \times \texttt{indvar}\)</span>$</p></li>
</ul>
</section>
</section>
<section id="example-2-another-perfect-linear-relationship">
<h2>Example 2: another perfect linear relationship<a class="headerlink" href="#example-2-another-perfect-linear-relationship" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;depvar&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
       <span class="s1">&#39;indvar&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">)}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>depvar</th>
      <th>indvar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;indvar&#39;</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;depvar&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;indvar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;depvar&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a98c8b595ab3318d1b9a4175f7c859f2ca19fc6aa3a94009d86ac98eb0add0f9.png" src="../../../_images/a98c8b595ab3318d1b9a4175f7c859f2ca19fc6aa3a94009d86ac98eb0add0f9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;depvar ~ indvar&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span> <span class="c1"># setup the model</span>

<span class="n">regmod_fit</span> <span class="o">=</span> <span class="n">regmod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># estimate/fit the model </span>

<span class="n">regmod_fit</span><span class="o">.</span><span class="n">params</span> <span class="c1"># get parameter estimates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    2.0
indvar       1.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The scatter plot is similar to Example 1 except that the values of the dependent variable has been increased by 2.</p></li>
<li><p>The equation of the regression line for this data is:  $<span class="math notranslate nohighlight">\(\texttt{depvar} = 2 + 1 \times \texttt{indvar} \)</span>$</p></li>
</ul>
<section id="interpretation-of-y-intercept">
<h3>Interpretation of y-intercept<a class="headerlink" href="#interpretation-of-y-intercept" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>When the independent variable is 0 the dependent variable is 2.  This is the meaning of the <strong>y-intercept</strong> value of 2.</p></li>
</ul>
</section>
<section id="interpretation-of-slope">
<h3>Interpretation of slope<a class="headerlink" href="#interpretation-of-slope" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>For a one-unit change in the independent variable the dependent variable changes by 1 unit.</p></li>
</ul>
</section>
</section>
<section id="example-3-close-to-linear">
<h2>Example 3: close to linear<a class="headerlink" href="#example-3-close-to-linear" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Examples 1 and 2 were perfect linear relationships.</p></li>
<li><p>In this example we examine what happens if the relationship between the dependent and independent variables is almost linear.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1">#set the seed so that it&#39;s reproducible</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;depvar&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;indvar&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>depvar</th>
      <th>indvar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0.360539</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1.038950</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>2.926437</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>4.449868</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>4.840407</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>5.970854</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>6.025562</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>7.974743</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;indvar&#39;</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;depvar&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;indvar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;depvar&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/91eab4102c10d596cfe19be2cf8a1bd438a6afb5521080cc688d27ea10eab596.png" src="../../../_images/91eab4102c10d596cfe19be2cf8a1bd438a6afb5521080cc688d27ea10eab596.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;depvar ~ indvar&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span> <span class="c1"># setup the model</span>

<span class="n">regmod_fit</span> <span class="o">=</span> <span class="n">regmod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># estimate/fit the model </span>

<span class="n">regmod_fit</span><span class="o">.</span><span class="n">params</span> <span class="c1"># get parameter estimates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    1.625418
indvar       0.922867
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>So, now the relationship isn’t perfectly linear, but close.  The equation of this regression line is:</p>
<div class="math notranslate nohighlight">
\[\texttt{depvar} = 1.63 + 0.92 \times \texttt{indvar}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;indvar&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;depvar&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="kc">None</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/624cf376f3b579a466c1b5e2c7bef7957c3e3a8e04af84b5b1884f1dd5940d72.png" src="../../../_images/624cf376f3b579a466c1b5e2c7bef7957c3e3a8e04af84b5b1884f1dd5940d72.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">regplot</span></code> function in the <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> library will produce a scatter plot with the regression line.</p>
<p>The parameters of <code class="docutils literal notranslate"><span class="pre">regplot</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is the independent variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> is the dependent variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ci</span> <span class="pre">=</span> <span class="pre">None</span></code> specifies no confidence interval for the regression line</p></li>
</ul>
<section id="statistical-summary-of-linear-regression">
<h3>Statistical summary of linear regression<a class="headerlink" href="#statistical-summary-of-linear-regression" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># turn off warnings</span>

<span class="n">regsum</span> <span class="o">=</span> <span class="n">regmod_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">regsum</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    1.6254</td> <td>    0.353</td> <td>    4.607</td> <td> 0.004</td> <td>    0.762</td> <td>    2.489</td>
</tr>
<tr>
  <th>indvar</th>    <td>    0.9229</td> <td>    0.073</td> <td>   12.700</td> <td> 0.000</td> <td>    0.745</td> <td>    1.101</td>
</tr>
</table></div></div>
</div>
<ul class="simple">
<li><p>A statistical summary of the regression model is given above using the <code class="docutils literal notranslate"><span class="pre">summary</span></code> function in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>.</p></li>
<li><p>There are three summary tables, but we will only be interested in the second summary table—<code class="docutils literal notranslate"><span class="pre">regsum.tables[1]</span></code> (in this course).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regsum</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    1.6254</td> <td>    0.353</td> <td>    4.607</td> <td> 0.004</td> <td>    0.762</td> <td>    2.489</td>
</tr>
<tr>
  <th>indvar</th>    <td>    0.9229</td> <td>    0.073</td> <td>   12.700</td> <td> 0.000</td> <td>    0.745</td> <td>    1.101</td>
</tr>
</table></div></div>
</div>
<p>What does the statistical summary represent?</p>
<ul class="simple">
<li><p>the column labelled <code class="docutils literal notranslate"><span class="pre">coef</span></code> are same values as <code class="docutils literal notranslate"><span class="pre">regmod_fit.params</span></code>.  In this case the average increase <code class="docutils literal notranslate"><span class="pre">depvar</span></code> for a one unit change in <code class="docutils literal notranslate"><span class="pre">indvar</span></code> is 0.9229.</p></li>
</ul>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">std</span> <span class="pre">err</span></code> column represents the standard deviation of the intercept and slope (we won’t discuss in this course).</p></li>
</ul>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">t</span></code> column represents the value of the t-statistic (we won’t discuss in this course).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regsum</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    1.6254</td> <td>    0.353</td> <td>    4.607</td> <td> 0.004</td> <td>    0.762</td> <td>    2.489</td>
</tr>
<tr>
  <th>indvar</th>    <td>    0.9229</td> <td>    0.073</td> <td>   12.700</td> <td> 0.000</td> <td>    0.745</td> <td>    1.101</td>
</tr>
</table></div></div>
</div>
<ul class="simple">
<li><p>the column <code class="docutils literal notranslate"><span class="pre">P&gt;|t|</span></code> represents the p-value corresponding to the null hypothesis that the intercept or slope are equal to 0.  If the value is small then this is evidence against the null hypothesis.  But if the p-value is large then there is no evidence against the null hypothesis.</p></li>
</ul>
<ul class="simple">
<li><p>Currently, how small a p-value should be to provide evidence against a null hypothesis is being debated.  Although, the traditional threshold is 0.05 (i.e., a p-value less than or equal to 0.05 is supposed to indicate evidence against the null hypothesis).</p></li>
</ul>
<ul class="simple">
<li><p>In the example above the p-value for the slope is 0.  This indicates strong evidence that the <em>true</em> value of the slope is non-zero.</p></li>
</ul>
<ul class="simple">
<li><p>The columns <code class="docutils literal notranslate"><span class="pre">[0.025</span>&#160;&#160; <span class="pre">0.975]</span></code> form a plausible range of values for the y-intercept and slope (formally known as a 95% confidence interval). In this case the plausible values for the slope are 0.745 and 1.101.  If the plausible range includes 0 then this is usually interpreted as not providing evidence against the null hypothesis.</p></li>
</ul>
</section>
</section>
<section id="predicted-values-and-residuals">
<h2>Predicted values and residuals<a class="headerlink" href="#predicted-values-and-residuals" title="Link to this heading">#</a></h2>
<p>If the values of the independent variable are plugged into the regression equation then we obtain the fitted values.</p>
<div class="math notranslate nohighlight">
\[\texttt{depvar} = 1.63 + 0.92 \times \texttt{indvar}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>depvar</th>
      <th>indvar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0.360539</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1.038950</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>2.926437</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>4.449868</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>4.840407</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>5.970854</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>6.025562</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>7.974743</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The fitted value for the first row of <code class="docutils literal notranslate"><span class="pre">df</span></code> is (when <code class="docutils literal notranslate"><span class="pre">indvar</span></code> == 0.360539) :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mf">1.6254</span> <span class="o">+</span> <span class="mf">0.9229</span><span class="o">*</span><span class="mf">0.360539</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.9581414431
</pre></div>
</div>
</div>
</div>
<p>To extract the fitted values from a regression model use the <code class="docutils literal notranslate"><span class="pre">fittedvalues</span></code> function in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">fittedvalues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.958148
1    2.584231
2    4.326129
3    5.732053
4    6.092469
5    7.135720
6    7.186208
7    8.985043
dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>If the linear regression model is used on an independent variable that is not in the data set used to build the model then it’s often referred to as a predicted value.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_indvar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;indvar&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">]})</span>
<span class="n">regmod_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_indvar</span><span class="p">[</span><span class="s1">&#39;indvar&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    10.854085
1    11.776952
2    12.699818
3    13.622685
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The residual is the dependent variable minus the fitted value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>depvar</th>
      <th>indvar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0.360539</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1.038950</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.958148
1    2.584231
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>So, for the first row the residual is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1.9581414431</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.041858556900000066
</pre></div>
</div>
</div>
</div>
<p>To extract the residuals from a regression model use the <code class="docutils literal notranslate"><span class="pre">resid</span></code> function in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">resid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.041852
1    0.415769
2   -0.326129
3   -0.732053
4   -0.092469
5   -0.135720
6    0.813792
7    0.014957
dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>If the linear regression model fits the data well then the residuals should be close to 0.</p></li>
<li><p>One indication that the linear regression model fits well is to examine the <strong>diagnostic</strong> scatter plot of residuals versus fitted values.</p></li>
<li><p><strong>A plot that looks like a random scatter of points around 0 indicates that linear regression is an appropriate model.</strong></p></li>
<li><p>Since there are only 8 points it’s hard to spot a pattern.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">regmod_fit</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;fitted values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;residuals&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;residuals&#39;)
</pre></div>
</div>
<img alt="../../../_images/ff7d9a042d0de6c9a1bdcffa4b58b01eb22d95ba742a3f5ccd692c740e967346.png" src="../../../_images/ff7d9a042d0de6c9a1bdcffa4b58b01eb22d95ba742a3f5ccd692c740e967346.png" />
</div>
</div>
</section>
<section id="accuracy-of-linear-regression">
<h2>Accuracy of linear regression<a class="headerlink" href="#accuracy-of-linear-regression" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>There are several measures of accuracy for linear regression.</p></li>
<li><p>One popular measure is R-squared, and root mean-squared error.</p></li>
<li><p>R-squared can be calculated from a fitted model regression model using the <code class="docutils literal notranslate"><span class="pre">rsquared</span></code> function in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>.</p></li>
<li><p>R-squared is always between 0 and 1.</p>
<ul>
<li><p>R-squared of 0 indicates a poor fit</p></li>
<li><p>R-squared of 1 indicates a perfect fit</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9641350308570086
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-4-regression-with-two-or-more-independent-variables">
<h2>Example 4: regression with two or more independent variables<a class="headerlink" href="#example-4-regression-with-two-or-more-independent-variables" title="Link to this heading">#</a></h2>
<p>It’s possible to include more than one independent variable in a regression model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1">#set the seed so that it&#39;s reproducible</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;depvar&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;indvar1&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">8</span><span class="p">),</span>
        <span class="s1">&#39;indvar2&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>depvar</th>
      <th>indvar1</th>
      <th>indvar2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0.360539</td>
      <td>-0.536629</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1.038950</td>
      <td>1.315403</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>2.926437</td>
      <td>2.421051</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>4.449868</td>
      <td>1.934397</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>4.840407</td>
      <td>3.113760</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>5.970854</td>
      <td>4.524267</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>6.025562</td>
      <td>6.689682</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9</td>
      <td>7.974743</td>
      <td>7.561192</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To include more than one independent variable in a regression model add it to the right side of syntax for describing statistical models.</p>
<p><code class="docutils literal notranslate"><span class="pre">'depvar</span> <span class="pre">~</span> <span class="pre">indvar1</span> <span class="pre">+</span> <span class="pre">indvar2'</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;depvar ~ indvar1 + indvar2&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span> <span class="c1"># setup the model</span>
</pre></div>
</div>
</div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">fit</span></code> <code class="docutils literal notranslate"><span class="pre">regmod</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span> <span class="o">=</span> <span class="n">regmod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># estimate/fit the model </span>
</pre></div>
</div>
</div>
</div>
<p>Extract the regression parameter estimates using <code class="docutils literal notranslate"><span class="pre">params</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">params</span> <span class="c1"># get parameter estimates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    1.892482
indvar1      0.549341
indvar2      0.385197
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The estimated linear (multiple) linear regression model is:</p>
<div class="math notranslate nohighlight">
\[\texttt{depvar} = 1.892482 + 0.549341 \times \texttt{indvar1} + 0.385197 \times \texttt{indvar2}\]</div>
<ul class="simple">
<li><p>The y-intercept value (1.892482) is the value of the dependent variable when <code class="docutils literal notranslate"><span class="pre">indvar1</span></code> and <code class="docutils literal notranslate"><span class="pre">indvar2</span></code> are both 0.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">indvar1</span></code> changes by one-unit, <code class="docutils literal notranslate"><span class="pre">depvar</span></code> changes (on average) by 0.549341 (when <code class="docutils literal notranslate"><span class="pre">indvar2</span></code> remains the same).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">indvar2</span></code> changes by one-unit, <code class="docutils literal notranslate"><span class="pre">depvar</span></code> changes (on average) by 0.385197 (when <code class="docutils literal notranslate"><span class="pre">indvar1</span></code> remains the same).</p></li>
</ul>
<section id="statistical-summary-of-a-multiple-regression-model">
<h3>Statistical summary of a multiple regression model<a class="headerlink" href="#statistical-summary-of-a-multiple-regression-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multregsummary</span> <span class="o">=</span> <span class="n">regmod_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="n">multregsummary</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    1.8925</td> <td>    0.201</td> <td>    9.432</td> <td> 0.000</td> <td>    1.377</td> <td>    2.408</td>
</tr>
<tr>
  <th>indvar1</th>   <td>    0.5493</td> <td>    0.102</td> <td>    5.411</td> <td> 0.003</td> <td>    0.288</td> <td>    0.810</td>
</tr>
<tr>
  <th>indvar2</th>   <td>    0.3852</td> <td>    0.097</td> <td>    3.984</td> <td> 0.010</td> <td>    0.137</td> <td>    0.634</td>
</tr>
</table></div></div>
</div>
<p>The statistical summary indicates:</p>
<ul class="simple">
<li><p>the p-value for <code class="docutils literal notranslate"><span class="pre">indvar1</span></code> is 0.003 and the range of plausible values for the slope is 0.288 to 0.810.</p></li>
<li><p>the p-value for <code class="docutils literal notranslate"><span class="pre">indvar2</span></code> is 0.010 and the range of plausible values for the slope is 0.137 to 0.634.</p></li>
<li><p>Since, both p-values are small there is evidence that slope is different from 0, and the range of plausible values does not include 0.</p></li>
</ul>
</section>
<section id="accuracy-of-multiple-regression-model">
<h3>Accuracy of multiple regression model<a class="headerlink" href="#accuracy-of-multiple-regression-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.991410032226906
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">regmod_fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">regmod_fit</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;fitted values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;residuals&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;residuals&#39;)
</pre></div>
</div>
<img alt="../../../_images/002e804599d7c3e4b420f09cd8f35b636da07d63879ab13ee118f98b7c55212f.png" src="../../../_images/002e804599d7c3e4b420f09cd8f35b636da07d63879ab13ee118f98b7c55212f.png" />
</div>
</div>
<p>Questions?</p>
</section>
</section>
<section id="what-is-the-effect-of-recent-immigration-on-asthma-rates-in-toronto-neighbourhoods">
<h2>What is the effect of recent immigration on asthma rates in Toronto neighbourhoods?<a class="headerlink" href="#what-is-the-effect-of-recent-immigration-on-asthma-rates-in-toronto-neighbourhoods" title="Link to this heading">#</a></h2>
<section id="id2">
<h3>Data<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Data from <a class="reference external" href="http://torontohealthprofiles.ca">http://torontohealthprofiles.ca</a> contains data on asthma and immigration for each neighbourhood in Toronto.</p></li>
</ul>
<section id="sociodemographic-data">
<h4>Sociodemographic data<a class="headerlink" href="#sociodemographic-data" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Read sociodemographic data from the excel file <code class="docutils literal notranslate"><span class="pre">1_socdem_neighb_2006-2.xls</span></code> with sheet name <code class="docutils literal notranslate"><span class="pre">socdem_2006</span></code> into <code class="docutils literal notranslate"><span class="pre">pandas</span></code> using <code class="docutils literal notranslate"><span class="pre">read_excel</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;1_socdem_neighb_2006-2.xls&#39;</span>
<span class="n">sname</span> <span class="o">=</span> <span class="s1">&#39;socdem_2006&#39;</span>
<span class="n">socdem_neighb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sname</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># the table starts in row #10</span>
<span class="n">socdem_neighb</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Neighbourhood id</th>
      <th>Neighbourhood Name</th>
      <th>Total Population</th>
      <th>% 19 and under</th>
      <th>% 65 and over</th>
      <th>% Living alone</th>
      <th>% Aged 65+ living alone</th>
      <th>% Lone parent families §</th>
      <th>% 1 year mobility in population</th>
      <th>Median household income before-tax $</th>
      <th>...</th>
      <th>% Less than high school education **</th>
      <th>% With a University degree **</th>
      <th>% No knowledge of English/French</th>
      <th>% Recent immigrants-within 5 years</th>
      <th>% Recent immigrants-within 10 years</th>
      <th>% Immigrants</th>
      <th>% Visible minority</th>
      <th>Top 3 Home Languages for non-English speaking households, #1</th>
      <th>Top 3 Home Languages for non-English speaking households, #2</th>
      <th>Top 3 Home Languages for non-English speaking households, #3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>32252</td>
      <td>26.8</td>
      <td>11.3</td>
      <td>3.7</td>
      <td>11.7</td>
      <td>26.3</td>
      <td>11.6</td>
      <td>63413</td>
      <td>...</td>
      <td>18.4</td>
      <td>22.9</td>
      <td>5.4</td>
      <td>12.2</td>
      <td>22.1</td>
      <td>60.0</td>
      <td>77.9</td>
      <td>Panjabi (Punjabi)</td>
      <td>Gujarati</td>
      <td>Spanish</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>32127</td>
      <td>32.2</td>
      <td>8.1</td>
      <td>4.1</td>
      <td>15.4</td>
      <td>31.5</td>
      <td>15.7</td>
      <td>48146</td>
      <td>...</td>
      <td>20.1</td>
      <td>23.6</td>
      <td>7.6</td>
      <td>22.2</td>
      <td>35.1</td>
      <td>67.1</td>
      <td>85.3</td>
      <td>Panjabi (Punjabi)</td>
      <td>Gujarati</td>
      <td>Arabic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>9928</td>
      <td>25.3</td>
      <td>16.7</td>
      <td>5.4</td>
      <td>17.5</td>
      <td>30.1</td>
      <td>10.9</td>
      <td>55032</td>
      <td>...</td>
      <td>16.7</td>
      <td>20.7</td>
      <td>5.0</td>
      <td>9.7</td>
      <td>19.3</td>
      <td>55.9</td>
      <td>53.8</td>
      <td>Panjabi (Punjabi)</td>
      <td>Italian</td>
      <td>Spanish</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>10725</td>
      <td>23.6</td>
      <td>18.3</td>
      <td>10.2</td>
      <td>28.8</td>
      <td>33.3</td>
      <td>13.2</td>
      <td>52428</td>
      <td>...</td>
      <td>15.3</td>
      <td>18.8</td>
      <td>3.0</td>
      <td>8.3</td>
      <td>14.0</td>
      <td>47.2</td>
      <td>41.8</td>
      <td>Spanish</td>
      <td>Panjabi (Punjabi)</td>
      <td>Croatian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>9437</td>
      <td>29.9</td>
      <td>10.5</td>
      <td>5.8</td>
      <td>13.0</td>
      <td>39.1</td>
      <td>9.7</td>
      <td>53779</td>
      <td>...</td>
      <td>15.2</td>
      <td>18.8</td>
      <td>3.6</td>
      <td>9.8</td>
      <td>18.2</td>
      <td>53.8</td>
      <td>60.5</td>
      <td>Spanish</td>
      <td>Italian</td>
      <td>Urdu</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div></div></div>
</div>
<p>Which column should we select to measure immigration?  There are several choices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">socdem_neighb</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Neighbourhood id&#39;, &#39;Neighbourhood Name&#39;, &#39;Total Population&#39;,
       &#39;% 19 and under&#39;, &#39;% 65 and over&#39;, &#39;% Living alone&#39;,
       &#39;% Aged 65+ living alone&#39;, &#39;% Lone parent families §&#39;,
       &#39;% 1 year mobility in population&#39;,
       &#39;Median household income before-tax $&#39;,
       &#39;Median household income after-tax $ ‡&#39;,
       &#39;% Families-Incidence of low income before-tax&#39;,
       &#39;% Families-Incidence of low income after-tax ‡&#39;,
       &#39;% Individuals-Incidence of low income before-tax&#39;,
       &#39;% Individuals-Incidence of low income after-tax ‡&#39;,
       &#39;% Rented Dwellings&#39;, &#39;% Unemployment rate *&#39;,
       &#39;% Not in labour force *&#39;, &#39;% Less than high school education **&#39;,
       &#39;% With a University degree **&#39;, &#39;% No knowledge of English/French&#39;,
       &#39;% Recent immigrants-within 5 years&#39;,
       &#39;% Recent immigrants-within 10 years&#39;, &#39;% Immigrants&#39;,
       &#39;% Visible minority&#39;,
       &#39;Top 3 Home Languages for non-English speaking households, #1&#39;,
       &#39;Top 3 Home Languages for non-English speaking households, #2&#39;,
       &#39;Top 3 Home Languages for non-English speaking households, #3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Let’s use <code class="docutils literal notranslate"><span class="pre">'%</span> <span class="pre">Recent</span> <span class="pre">immigrants-within</span> <span class="pre">5</span> <span class="pre">years'</span></code> to represent recent immigrants in a neighborhood.</p></li>
<li><p>Later on we will want a few more sociodemographic columns, so let’s create a new <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and rename the columns.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Neighbourhood id&#39;</span><span class="p">,</span> <span class="s1">&#39;Neighbourhood Name&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Median household income after-tax $ ‡&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;% Rented Dwellings&#39;</span><span class="p">,</span> <span class="s1">&#39;% Unemployment rate *&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;% Recent immigrants-within 5 years&#39;</span><span class="p">,</span> <span class="s1">&#39;% Visible minority&#39;</span><span class="p">]</span>

<span class="n">socdem_neighb</span> <span class="o">=</span> <span class="n">socdem_neighb</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>

<span class="n">colnames</span> <span class="o">=</span> <span class="p">{</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;Neighbid&#39;</span><span class="p">,</span>
            <span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
            <span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;median_income&#39;</span><span class="p">,</span>
            <span class="n">cols</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;rented_dwell&#39;</span><span class="p">,</span>
            <span class="n">cols</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;unemployment&#39;</span><span class="p">,</span>
            <span class="n">cols</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;immigration5&#39;</span><span class="p">,</span>
            <span class="n">cols</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;vismin&#39;</span><span class="p">}</span>

<span class="n">socdem_neighb</span> <span class="o">=</span> <span class="n">socdem_neighb</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">socdem_neighb</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">socdem_neighb</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Neighbid</th>
      <th>name</th>
      <th>median_income</th>
      <th>rented_dwell</th>
      <th>unemployment</th>
      <th>immigration5</th>
      <th>vismin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>56220</td>
      <td>27.4</td>
      <td>7.0</td>
      <td>12.2</td>
      <td>77.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>43975</td>
      <td>52.0</td>
      <td>9.9</td>
      <td>22.2</td>
      <td>85.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>49800</td>
      <td>34.4</td>
      <td>6.3</td>
      <td>9.7</td>
      <td>53.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>46033</td>
      <td>45.1</td>
      <td>7.7</td>
      <td>8.3</td>
      <td>41.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>48055</td>
      <td>41.2</td>
      <td>7.8</td>
      <td>9.8</td>
      <td>60.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="asthma-data">
<h4>Asthma data<a class="headerlink" href="#asthma-data" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Read data from the excel file <code class="docutils literal notranslate"><span class="pre">1_ahd_neighb_db_ast_hbp_mhv_copd_2007.xls</span></code> with sheet name <code class="docutils literal notranslate"><span class="pre">1_ahd_neighb_asthma_2007</span></code> into <code class="docutils literal notranslate"><span class="pre">pandas</span></code> using <code class="docutils literal notranslate"><span class="pre">read_excel</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;1_ahd_neighb_db_ast_hbp_mhv_copd_2007.xls&#39;</span>
<span class="n">sname</span> <span class="o">=</span> <span class="s1">&#39;1_ahd_neighb_asthma_2007&#39;</span>

<span class="n">asthma_neighb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sname</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span> <span class="c1">#the table starts with row #11</span>
<span class="n">asthma_neighb</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 1</th>
      <th>Demographics ª</th>
      <th>% With asthma</th>
      <th>LL (95% CI)</th>
      <th>UL (95% CI)</th>
      <th>Demographics ª.1</th>
      <th>% With asthma.1</th>
      <th>LL (95% CI) .1</th>
      <th>UL (95% CI) .1</th>
      <th>...</th>
      <th>Demographics ª.7</th>
      <th>% With asthma.7</th>
      <th>LL (95% CI) .7</th>
      <th>UL (95% CI) .7</th>
      <th>Demographics ª.8</th>
      <th>% With asthma.8</th>
      <th>LL (95% CI) .8</th>
      <th>UL (95% CI) .8</th>
      <th>Rate Ratio**.2</th>
      <th>H/L/NS.2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>11977</td>
      <td>9.7</td>
      <td>9.2</td>
      <td>10.2</td>
      <td>11770</td>
      <td>10.6</td>
      <td>10.0</td>
      <td>11.2</td>
      <td>...</td>
      <td>4435</td>
      <td>12.3</td>
      <td>11.3</td>
      <td>13.3</td>
      <td>8921</td>
      <td>10.9</td>
      <td>10.3</td>
      <td>11.6</td>
      <td>1.07</td>
      <td>H</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>11157</td>
      <td>7.9</td>
      <td>7.4</td>
      <td>8.4</td>
      <td>11462</td>
      <td>10.2</td>
      <td>9.6</td>
      <td>10.8</td>
      <td>...</td>
      <td>3819</td>
      <td>13.5</td>
      <td>12.5</td>
      <td>14.6</td>
      <td>7726</td>
      <td>11.2</td>
      <td>10.5</td>
      <td>11.9</td>
      <td>1.10</td>
      <td>H</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>3307</td>
      <td>9.4</td>
      <td>8.4</td>
      <td>10.4</td>
      <td>3322</td>
      <td>10.5</td>
      <td>9.5</td>
      <td>11.6</td>
      <td>...</td>
      <td>1307</td>
      <td>12.3</td>
      <td>10.5</td>
      <td>14.1</td>
      <td>2587</td>
      <td>10.8</td>
      <td>9.6</td>
      <td>12.0</td>
      <td>1.06</td>
      <td>NS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>3317</td>
      <td>9.7</td>
      <td>8.7</td>
      <td>10.7</td>
      <td>3438</td>
      <td>13.0</td>
      <td>11.9</td>
      <td>14.2</td>
      <td>...</td>
      <td>1468</td>
      <td>13.2</td>
      <td>11.5</td>
      <td>14.9</td>
      <td>2897</td>
      <td>10.4</td>
      <td>9.3</td>
      <td>11.5</td>
      <td>1.02</td>
      <td>NS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>3209</td>
      <td>10.2</td>
      <td>9.1</td>
      <td>11.2</td>
      <td>3379</td>
      <td>13.0</td>
      <td>11.8</td>
      <td>14.1</td>
      <td>...</td>
      <td>1314</td>
      <td>15.1</td>
      <td>13.1</td>
      <td>17.0</td>
      <td>2610</td>
      <td>11.8</td>
      <td>10.6</td>
      <td>13.0</td>
      <td>1.16</td>
      <td>H</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 44 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>The asthma rates are broken down by sex and age.</p></li>
<li><p>Which rates should we choose?</p></li>
<li><p>For this example, let’s select asthma rates for both sexes age 20 - 64.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asthma_neighb</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Unnamed: 0&#39;, &#39;Unnamed: 1&#39;, &#39;Demographics ª&#39;, &#39;% With asthma&#39;,
       &#39;LL (95% CI) &#39;, &#39;UL (95% CI) &#39;, &#39;Demographics ª.1&#39;, &#39;% With asthma.1&#39;,
       &#39;LL (95% CI) .1&#39;, &#39;UL (95% CI) .1&#39;, &#39;Demographics ª.2&#39;,
       &#39;% With asthma.2&#39;, &#39;LL (95% CI) .2&#39;, &#39;UL (95% CI) .2&#39;, &#39;Rate Ratio**&#39;,
       &#39;H/L/NS&#39;, &#39;Demographics ª.3&#39;, &#39;% With asthma.3&#39;, &#39;LL (95% CI) .3&#39;,
       &#39;UL (95% CI) .3&#39;, &#39;Demographics ª.4&#39;, &#39;% With asthma.4&#39;,
       &#39;LL (95% CI) .4&#39;, &#39;UL (95% CI) .4&#39;, &#39;Demographics ª.5&#39;,
       &#39;% With asthma.5&#39;, &#39;LL (95% CI) .5&#39;, &#39;UL (95% CI) .5&#39;, &#39;Rate Ratio**.1&#39;,
       &#39;H/L/NS.1&#39;, &#39;Demographics ª.6&#39;, &#39;% With asthma.6&#39;, &#39;LL (95% CI) .6&#39;,
       &#39;UL (95% CI) .6&#39;, &#39;Demographics ª.7&#39;, &#39;% With asthma.7&#39;,
       &#39;LL (95% CI) .7&#39;, &#39;UL (95% CI) .7&#39;, &#39;Demographics ª.8&#39;,
       &#39;% With asthma.8&#39;, &#39;LL (95% CI) .8&#39;, &#39;UL (95% CI) .8&#39;, &#39;Rate Ratio**.2&#39;,
       &#39;H/L/NS.2&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the neghborhood_id, neighborhood_name, and both sexes with asthma</span>

<span class="n">important_cols</span> <span class="o">=</span> <span class="n">asthma_neighb</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colnames</span> <span class="o">=</span> <span class="p">{</span><span class="n">important_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;Neighbid&#39;</span><span class="p">,</span>
           <span class="n">important_cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
           <span class="n">important_cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;asthma_pct&#39;</span><span class="p">}</span>

<span class="n">asthma_rates</span> <span class="o">=</span> <span class="n">asthma_neighb</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">asthma_rates</span> <span class="o">=</span> <span class="n">asthma_rates</span><span class="p">[</span><span class="n">important_cols</span><span class="p">]</span>

<span class="n">asthma_rates</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">asthma_rates</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Neighbid</th>
      <th>name</th>
      <th>asthma_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>10.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>9.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>11.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>11.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="merge-sociodemographic-and-asthma-data">
<h3>Merge Sociodemographic and asthma data<a class="headerlink" href="#merge-sociodemographic-and-asthma-data" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>To examine the relationship between asthma and immigration we will need to merge <code class="docutils literal notranslate"><span class="pre">socdem_neighb</span></code> and <code class="docutils literal notranslate"><span class="pre">asthma_rates</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s can be merged on neighbourhood id.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Two datasets are merged based on neighborhood id</span>

<span class="n">asthma_socdem</span> <span class="o">=</span> <span class="n">asthma_rates</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">socdem_neighb</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Neighbid&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Neighbid&#39;</span><span class="p">)</span>

<span class="n">asthma_socdem</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Neighbid</th>
      <th>name_x</th>
      <th>asthma_pct</th>
      <th>name_y</th>
      <th>median_income</th>
      <th>rented_dwell</th>
      <th>unemployment</th>
      <th>immigration5</th>
      <th>vismin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>10.2</td>
      <td>West Humber-Clairville</td>
      <td>56220</td>
      <td>27.4</td>
      <td>7.0</td>
      <td>12.2</td>
      <td>77.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>9.1</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>43975</td>
      <td>52.0</td>
      <td>9.9</td>
      <td>22.2</td>
      <td>85.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>10.0</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>49800</td>
      <td>34.4</td>
      <td>6.3</td>
      <td>9.7</td>
      <td>53.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>11.4</td>
      <td>Rexdale-Kipling</td>
      <td>46033</td>
      <td>45.1</td>
      <td>7.7</td>
      <td>8.3</td>
      <td>41.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>11.6</td>
      <td>Elms-Old Rexdale</td>
      <td>48055</td>
      <td>41.2</td>
      <td>7.8</td>
      <td>9.8</td>
      <td>60.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="a-regression-model-of-asthma-on-immigration">
<h2>A regression model of asthma on immigration<a class="headerlink" href="#a-regression-model-of-asthma-on-immigration" title="Link to this heading">#</a></h2>
<section id="id3">
<h3>Plot the data<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>What are the dependent and independent variables?</p></li>
<li><p>Does the relationship look linear?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;asthma_pct&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;immigration5&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">asthma_socdem</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="kc">None</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/3d1c040b1c2c0902f91b2bf3bf7afbf595ea7483a74b5deb3c05d5f843904694.png" src="../../../_images/3d1c040b1c2c0902f91b2bf3bf7afbf595ea7483a74b5deb3c05d5f843904694.png" />
</div>
</div>
<p>Describe the relationship between asthma and immigration.</p>
</section>
<section id="fit-the-regression-model">
<h3>Fit the regression model<a class="headerlink" href="#fit-the-regression-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_asthmaimm</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;asthma_pct ~ immigration5&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">asthma_socdem</span><span class="p">)</span> <span class="c1"># setup the model</span>

<span class="n">reg_asthmaimm_fit</span> <span class="o">=</span> <span class="n">regmod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># estimate/fit the model </span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="statistical-summary-of-the-regression-model">
<h3>Statistical summary of the regression model<a class="headerlink" href="#statistical-summary-of-the-regression-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_asthmaimm_summ</span> <span class="o">=</span> <span class="n">reg_asthmaimm_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="n">reg_asthmaimm_summ</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    1.8925</td> <td>    0.201</td> <td>    9.432</td> <td> 0.000</td> <td>    1.377</td> <td>    2.408</td>
</tr>
<tr>
  <th>indvar1</th>   <td>    0.5493</td> <td>    0.102</td> <td>    5.411</td> <td> 0.003</td> <td>    0.288</td> <td>    0.810</td>
</tr>
<tr>
  <th>indvar2</th>   <td>    0.3852</td> <td>    0.097</td> <td>    3.984</td> <td> 0.010</td> <td>    0.137</td> <td>    0.634</td>
</tr>
</table></div></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-regression-model-is-the-equation">
<h1>The regression model is the equation:<a class="headerlink" href="#the-regression-model-is-the-equation" title="Link to this heading">#</a></h1>
<div class="math notranslate nohighlight">
\[\texttt{asthma_pct} = 11.8266  - 0.1597 \times \texttt{immigration5}\]</div>
<ul class="simple">
<li><p>The <strong>slope</strong> indicates that for a 1% <strong>increase</strong> in immigration in the past 5 years the percentage of asthma cases in a neighbourhood <strong>decrease</strong> by 0.1597 (approximately 16%).</p></li>
<li><p>The <strong>y-intercept</strong> indicates that when a neighbourhood has 0% immigration the past 5 years then asthma rates are 11%.</p></li>
<li><p>Are there any neighbourhoods with 0% immigration in the past 5 years?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asthma_socdem</span><span class="p">[</span><span class="s1">&#39;asthma_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    140.000000
mean      10.251429
std        1.647692
min        6.000000
25%        9.200000
50%       10.450000
75%       11.400000
max       14.000000
Name: asthma_pct, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The <strong>y-intercept</strong> in regression models often doesn’t have a sensible interpretation, but is often mathematically important for regression to work well.</p></li>
</ul>
<section id="accuracy-of-the-regression-model">
<h2>Accuracy of the regression model<a class="headerlink" href="#accuracy-of-the-regression-model" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_asthmaimm_fit</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.991410032226906
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">reg_asthmaimm_fit</span><span class="o">.</span><span class="n">fittedvalues</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">reg_asthmaimm_fit</span><span class="o">.</span><span class="n">resid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;fitted values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;residuals&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;residuals&#39;)
</pre></div>
</div>
<img alt="../../../_images/002e804599d7c3e4b420f09cd8f35b636da07d63879ab13ee118f98b7c55212f.png" src="../../../_images/002e804599d7c3e4b420f09cd8f35b636da07d63879ab13ee118f98b7c55212f.png" />
</div>
</div>
<ul class="simple">
<li><p>The R-squared statistics indicates a very good explanation of the model (close to 1)</p></li>
<li><p>The residuals seem randomly distributed, indicating the model is appropriate.</p></li>
</ul>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h3>
<p>Therefore, we can conclude that the immigration rate in recent 5 years in a neighborhood is negatively associated with the prevalence of asthma in the neighborhood.</p>
<p>Why not causal relationship?</p>
<p>What is the implication?</p>
</section>
</section>
<section id="training-and-testing-a-model">
<h2>Training and testing a model<a class="headerlink" href="#training-and-testing-a-model" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Ideally we could assess the accuracy of this linear regression model on a new set of data (i.e., immigration rates in Toronto neighbourhoods in future years.)</p></li>
<li><p>But, we don’t have this data.</p></li>
<li><p>One trick that data scientists use to fit the model on part of the data (training data) and use the remaining part (testing data) to test the accuracy.</p></li>
<li><p>If we only have one data set then the training data can be obtained by randomly selecting rows from the data to fit the regression model, then the remaining rows can be used to test the accuracy of the model.</p></li>
</ul>
<section id="splitting-a-pandas-dataframe-by-index">
<h3>Splitting a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by <code class="docutils literal notranslate"><span class="pre">index</span></code><a class="headerlink" href="#splitting-a-pandas-dataframe-by-index" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=5, step=1)
</pre></div>
</div>
</div>
</div>
<p>A Boolean array that is <code class="docutils literal notranslate"><span class="pre">True</span></code> if the index is <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ True,  True, False, False, False])
</pre></div>
</div>
</div>
</div>
<p>To create a Boolean series that is <code class="docutils literal notranslate"><span class="pre">False</span></code> if the index is <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">True</span></code> otherwise we can negate <code class="docutils literal notranslate"><span class="pre">df.index.isin([0,1])</span></code> this Boolean series using the <code class="docutils literal notranslate"><span class="pre">~</span></code> operator <code class="docutils literal notranslate"><span class="pre">~df.index.isin([0,1])</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([False, False,  True,  True,  True])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="creating-training-and-test-data-sets-from-a-single-dataset">
<h3>Creating training and test data sets from a single dataset<a class="headerlink" href="#creating-training-and-test-data-sets-from-a-single-dataset" title="Link to this heading">#</a></h3>
</section>
<section id="step-1">
<h3>Step 1:<a class="headerlink" href="#step-1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>split the data into a training set with 75% of the rows.</p></li>
<li><p>use the remaining 25% of the data for testing.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># for reproducibility</span>

<span class="c1"># randomly select 75% of neighbourhoods</span>
<span class="n">reg_df_train</span> <span class="o">=</span> <span class="n">asthma_socdem</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> 

<span class="c1"># get index of training data</span>
<span class="n">train_index</span> <span class="o">=</span> <span class="n">reg_df_train</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Exclude indicies from <code class="docutils literal notranslate"><span class="pre">reg_df_train</span></code> using <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">isin</span></code> function.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># exclude rows in training to define test data</span>
<span class="n">reg_df_test</span> <span class="o">=</span> <span class="n">asthma_socdem</span><span class="p">[</span><span class="o">~</span><span class="n">asthma_socdem</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">train_index</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">asthma_socdem</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">reg_df_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">reg_df_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(140, 9)
(105, 9)
(35, 9)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-fit-the-regression-model-on-the-training-data">
<h3>Step 2: Fit the regression model on the training data<a class="headerlink" href="#step-2-fit-the-regression-model-on-the-training-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_train</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;asthma_pct ~ immigration5&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">reg_df_train</span><span class="p">)</span> <span class="c1"># setup the model</span>

<span class="n">reg_train_fit</span> <span class="o">=</span> <span class="n">reg_train</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># estimate/fit the model </span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-compute-predicted-fitted-values-using-training-data">
<h3>Step 3: Compute predicted (fitted) values using training data<a class="headerlink" href="#step-3-compute-predicted-fitted-values-using-training-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the model fit on the training data to predict asthma rates</span>
<span class="c1"># from the test set. </span>

<span class="n">predvalues_train</span> <span class="o">=</span> <span class="n">reg_train_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">reg_df_train</span><span class="p">[</span><span class="s1">&#39;immigration5&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-evaluate-accuracy-using-root-mean-squared-error-on-training-data">
<h3>Step 4: Evaluate accuracy using root mean-squared error on training data<a class="headerlink" href="#step-4-evaluate-accuracy-using-root-mean-squared-error-on-training-data" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Another measure of accuracy of regression models.</p></li>
<li><p>Compares observed values of the dependent variable with the predicted values.</p></li>
</ul>
<p><img alt="rmse.jpg" src="../../../_images/insights_rmse_formula.jpg" /></p>
<p>It can be computed using the <code class="docutils literal notranslate"><span class="pre">rmse</span></code> function from <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute root mean-squared error for the training data.</span>
<span class="kn">from</span> <span class="nn">statsmodels.tools.eval_measures</span> <span class="kn">import</span> <span class="n">rmse</span>

<span class="n">rmse</span><span class="p">(</span><span class="n">predvalues_train</span><span class="p">,</span> <span class="n">reg_df_train</span><span class="p">[</span><span class="s1">&#39;asthma_pct&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.3987103239995489
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The observed asthma rates deviate from the predicted asthma rates in each neighbourhood by 1.4% in the training set.</p></li>
<li><p>Is this an acceptable prediction error?</p></li>
<li><p>Let’s examine the accuracy of the linear regression model on the test set</p></li>
</ul>
</section>
<section id="step-5-evaluate-the-accuracy-of-regression-model-on-the-test-data-using-root-mean-squared-error">
<h3>Step 5: Evaluate the accuracy of regression model on the test data using root mean-squared error<a class="headerlink" href="#step-5-evaluate-the-accuracy-of-regression-model-on-the-test-data-using-root-mean-squared-error" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Compute predictions using test data</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predvalues_test</span> <span class="o">=</span> <span class="n">reg_train_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">reg_df_test</span><span class="p">[</span><span class="s1">&#39;immigration5&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Now compute the root mean-squared error for the test data using the model fit on the training data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse</span><span class="p">(</span><span class="n">predvalues_test</span><span class="p">,</span> <span class="n">reg_df_test</span><span class="p">[</span><span class="s1">&#39;asthma_pct&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.109621980506299
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion-of-data-analysis-using-linear-regression-model">
<h2>Conclusion of data analysis using linear regression model<a class="headerlink" href="#conclusion-of-data-analysis-using-linear-regression-model" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The regression model appears to provide an accurate fit the data, although both the scatter plot and plot of residuals indicate that there is a lot of variation in asthma rates in neighbourhoods that have between 10% - 20% immigration.</p></li>
<li><p>As the percentage of immigrants to a neighbourhood within the last 5 years increases, the asthma rates will decreases.</p></li>
<li><p>Regression analyses on aggregated data such as neighbourhoods can be misleading when compared to non-aggregated data.</p></li>
</ul>
</section>
<section id="are-there-other-sociaodemographic-factors-in-our-data-that-might-effect-asthma-rates">
<h2>Are there other sociaodemographic  factors in our data that might effect asthma rates?<a class="headerlink" href="#are-there-other-sociaodemographic-factors-in-our-data-that-might-effect-asthma-rates" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Let’s create a matrix scatter plot using <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.pairplot.html"><code class="docutils literal notranslate"><span class="pre">pairplot</span></code></a> in the <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> library.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pairplot</span></code> will visualize paired relationship between variables in a dataset.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asthma_socdem</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Neighbid&#39;, &#39;name_x&#39;, &#39;asthma_pct&#39;, &#39;name_y&#39;, &#39;median_income&#39;,
       &#39;rented_dwell&#39;, &#39;unemployment&#39;, &#39;immigration5&#39;, &#39;vismin&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reduce the column for better presentation</span>
<span class="n">to_show</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;asthma_pct&#39;</span><span class="p">,</span><span class="s1">&#39;median_income&#39;</span><span class="p">,</span><span class="s1">&#39;rented_dwell&#39;</span><span class="p">,</span><span class="s1">&#39;immigration5&#39;</span><span class="p">,</span><span class="s1">&#39;vismin&#39;</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">asthma_socdem</span><span class="p">[</span><span class="n">to_show</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/99e5dc5bd7173ef809331fbc109a49c718ab8d873b6dfbdbe360ecc6c442d4df.png" src="../../../_images/99e5dc5bd7173ef809331fbc109a49c718ab8d873b6dfbdbe360ecc6c442d4df.png" />
</div>
</div>
<ul class="simple">
<li><p>Let’s consider median income</p></li>
<li><p>Fit the regression model on all the data and produce a statistical summary.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg_asthmaimmunem</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;asthma_pct ~ immigration5 + median_income&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">asthma_socdem</span><span class="p">)</span> <span class="c1"># setup the model</span>

<span class="n">reg_asthmaimmunem_fit</span> <span class="o">=</span> <span class="n">reg_asthmaimmunem</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span> <span class="c1"># estimate/fit the model </span>

<span class="n">reg_asthmaimmunem_summ</span> <span class="o">=</span> <span class="n">reg_asthmaimmunem_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<span class="n">reg_asthmaimmunem_summ</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>     <td>   14.3041</td> <td>    0.497</td> <td>   28.758</td> <td> 0.000</td> <td>   13.321</td> <td>   15.288</td>
</tr>
<tr>
  <th>immigration5</th>  <td>   -0.2054</td> <td>    0.019</td> <td>  -10.750</td> <td> 0.000</td> <td>   -0.243</td> <td>   -0.168</td>
</tr>
<tr>
  <th>median_income</th> <td>-4.048e-05</td> <td> 7.45e-06</td> <td>   -5.431</td> <td> 0.000</td> <td>-5.52e-05</td> <td>-2.57e-05</td>
</tr>
</table></div></div>
</div>
<ul class="simple">
<li><p>Notice that the slope estimate for <code class="docutils literal notranslate"><span class="pre">median_income</span></code> is 0, but so is the p-value and range of plausible values.</p></li>
<li><p>That seems odd.  What’s happening?</p></li>
<li><p>We can see from the scatter plot that <code class="docutils literal notranslate"><span class="pre">immigration5</span></code> and <code class="docutils literal notranslate"><span class="pre">median_income</span></code> have a linear relationship.  When two variables have a linear relationship multiple linear regression models produce strange results.</p></li>
<li><p>It’s important that independent variables in a multiple regression model are unrelated.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;immigration5&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;median_income&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">asthma_socdem</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="kc">None</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/10e553eff2df43384dda89238fcee3dea7abe79226c7a13b5c76c6754e8ce7bc.png" src="../../../_images/10e553eff2df43384dda89238fcee3dea7abe79226c7a13b5c76c6754e8ce7bc.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./weekly-materials/week09/lecture"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../week08/homework/Homework_8.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">GG274 Homework 8: Hypothesis Testing</p>
      </div>
    </a>
    <a class="right-next"
       href="../lab/Lab_9.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">GGR274 Lab 9: Project proposal feedback, data pre-processing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Class 9</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mar-12-2024">Mar. 12, 2024</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrangment-of-the-last-3-tutorials">Arrangment of the last 3 tutorials</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-start-with-a-story">Bootstrap - start with a story</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-this-a-good-idea">Why is this a good idea?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampled-mean">Resampled mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boostrap-confidence-intervals-cis">Boostrap confidence intervals (CIs)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-bootstrap-confidence-intervals-to-compare-samples">Using Bootstrap confidence intervals to compare samples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-people-with-no-children-under-14-spend-more-time-resting">Do people with no children under 14 spend more time resting?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-testing">Hypothesis testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-exercise">In-class exercise</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#another-method-to-compare-two-samples-a-review-of-shuffling">Another method to compare two samples (A review of shuffling)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-thought-expriement-shuffling-process">A thought expriement: shuffling process</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-shuffling-the-children-label-and-assignment-to-the-samples">Step 1: shuffling the children label and assignment to the samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-compute-the-mean-resting-time-difference-between-people-with-and-without-children">Step 2: compute the mean resting time difference between people with and without children</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-repeat-steps-1-and-2-a-large-number-of-times-e-g-5000-to-get-the-distribution-of-mean-differences">Step 3: Repeat Steps 1 and 2 a large number of times (e.g., 5000) to get the distribution of mean differences.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-compare-the-simulate-mean-differences-to-the-observed-mean-difference-and-calculate-p-value">Step 4: Compare the simulate mean differences to the observed mean difference and calculate p-value</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-interpretation">Step 5: Interpretation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#think-about">Think about:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-difference-between-bootstrap-and-shuffling">what is the difference between bootstrap and shuffling?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-idea">Basic idea</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-perfect-linear-relationship-between-dependent-and-independent-variables">Example 1: perfect linear relationship between dependent and independent variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-data">Plot the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-regression-line">Compute the regression line</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-another-perfect-linear-relationship">Example 2: another perfect linear relationship</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-y-intercept">Interpretation of y-intercept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-slope">Interpretation of slope</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-close-to-linear">Example 3: close to linear</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-summary-of-linear-regression">Statistical summary of linear regression</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predicted-values-and-residuals">Predicted values and residuals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-of-linear-regression">Accuracy of linear regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4-regression-with-two-or-more-independent-variables">Example 4: regression with two or more independent variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-summary-of-a-multiple-regression-model">Statistical summary of a multiple regression model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-of-multiple-regression-model">Accuracy of multiple regression model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-effect-of-recent-immigration-on-asthma-rates-in-toronto-neighbourhoods">What is the effect of recent immigration on asthma rates in Toronto neighbourhoods?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sociodemographic-data">Sociodemographic data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#asthma-data">Asthma data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-sociodemographic-and-asthma-data">Merge Sociodemographic and asthma data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-regression-model-of-asthma-on-immigration">A regression model of asthma on immigration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Plot the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-the-regression-model">Fit the regression model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-summary-of-the-regression-model">Statistical summary of the regression model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-regression-model-is-the-equation">The regression model is the equation:</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accuracy-of-the-regression-model">Accuracy of the regression model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-and-testing-a-model">Training and testing a model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#splitting-a-pandas-dataframe-by-index">Splitting a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by <code class="docutils literal notranslate"><span class="pre">index</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-training-and-test-data-sets-from-a-single-dataset">Creating training and test data sets from a single dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1">Step 1:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-fit-the-regression-model-on-the-training-data">Step 2: Fit the regression model on the training data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-compute-predicted-fitted-values-using-training-data">Step 3: Compute predicted (fitted) values using training data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-evaluate-accuracy-using-root-mean-squared-error-on-training-data">Step 4: Evaluate accuracy using root mean-squared error on training data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-evaluate-the-accuracy-of-regression-model-on-the-test-data-using-root-mean-squared-error">Step 5: Evaluate the accuracy of regression model on the test data using root mean-squared error</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-of-data-analysis-using-linear-regression-model">Conclusion of data analysis using linear regression model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#are-there-other-sociaodemographic-factors-in-our-data-that-might-effect-asthma-rates">Are there other sociaodemographic  factors in our data that might effect asthma rates?</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By GGR274 Instructors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>