
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Class 11 &#8212; Computation and Data Science for Social Sciences</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'weekly-materials/week11/lecture/Class11_GGR274_CL';</script>
    <link rel="icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="GGR274 Lab 11: Data analysis and result presentation" href="../lab/Lab_11.html" />
    <link rel="prev" title="Homework 10 : Linear Regression" href="../../week10/homework/marking/Homework_10_solution.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../jupyter-book/index.html">
  
  
  
  
  
  
    <p class="title logo__title">Computation and Data Science for Social Sciences</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../jupyter-book/index.html">
                    👋 Course Website for GGR274H1-S Winter 2024
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Quick Links</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../syllabus/ggr274_syllabus.html">Course Syllabus</a></li>
<li class="toctree-l1"><a class="reference external" href="https://q.utoronto.ca/courses/338580/announcements">Announcements</a></li>
<li class="toctree-l1"><a class="reference external" href="https://piazza.com/utoronto.ca/winter2024/ggr274h1">Piazza</a></li>
<li class="toctree-l1"><a class="reference external" href="https://forms.office.com/Pages/ResponsePage.aspx?id=JsKqeAMvTUuQN7RtVsVSEF-wqptfr85NieT8UyliaxxUOUtMSVFUQkFTNVdRTlVJNkZFQU84NldYUi4u">Course Feedback Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../guides/jupyterhub_guide.html">JupyterHub Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/markus_guide.html">MarkUs Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://q.utoronto.ca/courses/338580/files?preview=29750629">Prof. Li's Slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/lecture/Class1_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/lecture/Class1_GGR274_IM.html">Prof. Musabirov's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/lab/Lab_1.html">Lab 01 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/lab/Lab_1_solutions.html">Lab 01 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/homework/Homework_1.html">Homework 01 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week01/homework/Homework_1_solution.html">Homework 01 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week02/lecture/Class2_GGR274_DL_IM.html">Prof. Musabirov's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/lab/Lab_2.html">Lab 02 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/lab/Lab_2_solutions.html">Lab 02 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/homework/Homework_2.html">Homework 02 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week02/homework/Homework_2_solution.html">Homework 02 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week03/lecture/Class3_GGR274_DL_IM.html">Prof. Musabirov's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/lab/Lab_3.html">Lab 03 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/lab/Lab_3_solutions.html">Lab 03 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/homework/Homework_3.html">Homework 03 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week03/homework/Homework_3_solution.html">Homework 03 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://q.utoronto.ca/courses/338580/files?preview=30071956">Prof. Li's Slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/lecture/Class4_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/lab/Lab_4.html">Lab 04 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/lab/Lab_4_solutions.html">Lab 04 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/homework/Homework_4.html">Homework 04 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week04/homework/marking/Homework_4_solution.html">Homework 04 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week05/lecture/Class5_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/lab/Lab_5.html">Lab 05 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/lab/Lab_5_solutions.html">Lab 05 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/homework/Homework_5.html">Homework 05 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week05/homework/marking/Homework_5_solution.html">Homework 05 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice Midterm</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../practice/sample_midterm/GGR274_Midterm.html">2022 Midterm Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../practice/review_w1-3.html">Review of frequent errors and extra examples for weeks 1-3</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Midterm</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../tests/midterm/Midterm.html">Midterm Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tests/midterm-makeup/Midterm_makeup.html">Midterm (makeup) Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../project/proposal/GGR274_Project_Proposal.html">Project Proposal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../project/presentation/GGR274_Final_Project_Instruction.html">Final Project Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../project/presentation/extras/GGR274DSconfslides.html">Final Project Presentation Slides Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../project/presentation/extras/Tipsandtricksforslides.html">Additional Tips and Tricks for Creating Slides in a Jupyter Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://q.utoronto.ca/courses/338580/files?preview=30627394">Prof. Li's Slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/lecture/Class7_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/lab/Lab_7.html">Lab 07 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/lab/Lab_7_solutions.html">Lab 07 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/homework/Homework_7.html">Homework 07 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week07/homework/marking/Homework_7_solution.html">Homework 07 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week08/lecture/Class8_GGR274_MM.html">Prof. Moon's Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/lab/Lab_8.html">Lab 08 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/lab/marking/Lab_8_solution.html">Lab 08 Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/homework/Homework_8.html">Homework 08 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week08/homework/marking/Homework_8_solution.html">Homework 08 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week09/lecture/Class9_GGR274_CL.html">Class 9</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../week09/lab/Lab_9.html">Lab 09 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week09/homework/Homework_9.html">Homework 09 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week09/homework/marking/Homework_9_solution.html">Homework 09 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 10</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week10/lecture/Class10_GGR274_CL.html">Class 10</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../week10/lab/Lab_10.html">Lab 10 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week10/homework/Homework_10.html">Homework 10 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week10/homework/marking/Homework_10_solution.html">Homework 10 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 11</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Class 11</a></li>



<li class="toctree-l1"><a class="reference internal" href="../lab/Lab_11.html">Lab 11 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/Homework_11.html">Homework 11 Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/marking/Homework_11_solution.html">Homework 11 Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 12</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week12/lecture/Class12_GGR274_CL.html">Class 12</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../week12/lecture/Exercise/Cluster_analysis_exercise.html">Cluster Exercise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week12/lecture/Exercise/Cluster_analysis_solution.html">Cluster Exercise Solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practice Final</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../practice/final_exam_2022/ggr_final_answers_2022.html">2024 Final Exam Practice</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyter.utoronto.ca/hub/user-redirect/git-pull?repo=https%3A//github.com/UofTCompDSci/ggr274-20241&urlpath=tree/ggr274-20241/weekly-materials/week11/lecture/Class11_GGR274_CL.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/weekly-materials/week11/lecture/Class11_GGR274_CL.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Class 11</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Class 11</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mar-26-2024">Mar. 26, 2024</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#a-review-of-spatial-data-and-mapping">A review of spatial data and mapping</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-bring-in-the-same-files-we-worked-with-last-week">Let’s bring in the same files we worked with last week</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-geopandas-to-load-in-spatial-data">1. Using GeoPandas to load in spatial data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simplify-the-geodataframe">2. Simplify the geodataframe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-health-information-and-simplify-it">3. Import health information and simplify it</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#join-our-neighbourhood-gdf-with-our-asthma-rate-df">4. Join our neighbourhood gdf with our asthma rate df:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#map-the-attribute-data-asthma">5. Map the attribute data (asthma)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pop-quiz">POP QUIZ!!</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-cartography">More on Cartography</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-this-point-we-have-used-quantiles-to-classify-continous-values-in-maps">To this point we have used quantiles to classify continous values in maps.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-other-common-options-do-we-have-see-the-document-of-geodataframe-plot-and-mapclassify">What other common options do we have?  See the document of GeoDataFrame.plot and mapclassify</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-background">Adding a background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-reproject-the-map-into-web-mercator-and-compare-to-the-original-projection">Let’s reproject the map into Web Mercator and compare to the original projection:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-add-the-web-basemap-we-can-do-the-following">To add the web basemap, we can do the following</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-else-we-can-visualize-the-data-analysis-results-together">What else? We can visualize the data analysis results together!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-in-the-immigration-data">1. load in the immigration data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-dataset">2. Merge dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conduct-linear-regression">3. conduct linear regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-results">4. Visualize the results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-clustering">Introduction to clustering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-clustering">What is clustering?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-do-we-want-to-identify-clusters">Why do we want to identify clusters?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-clustering-at-a-high-level-is-doing-the-same-thing-but-one-attribute-to-consider-is-geography">Spatial clustering, at a high level, is doing the same thing but one attribute to consider is geography.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#if-we-want-to-do-spatial-clustering-of-a-variable-what-two-pieces-of-information-do-we-need-don-t-over-think">If we want to do ‘spatial clustering’ of a variable what two pieces of information do we need? (don’t over think!!!)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelation">Autocorrelation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-autocorrelation">Spatial Autocorrelation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#so-again-information-do-we-need-to-do-answer-this-question">So again, information do we need to do answer this question?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-each-observation-in-this-case-neighborhood-we-need-to-know-their-neighbours">1) For each observation (in this case, neighborhood) we need to know their neighbours!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#next-we-need-to-describe-the-value-of-our-attribute-of-interest-in-neighbours">2) Next we need to describe the value of our attribute of interest in neighbours</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finally-now-we-can-see-how-a-neighbourhood-s-attribute-compares-to-its-neighbours">3) Finally, now we can see how a neighbourhood’s attribute compares to its neighbours.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-will-talk-about-the-code-to-show-how-this-works-next-week">We will talk about the code to show how this works next week.</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="class-11">
<h1>Class 11<a class="headerlink" href="#class-11" title="Link to this heading">#</a></h1>
<section id="mar-26-2024">
<h2>Mar. 26, 2024<a class="headerlink" href="#mar-26-2024" title="Link to this heading">#</a></h2>
<p>By the end of this class, you’ll be able to:</p>
<ul class="simple">
<li><p>Load in spatial data</p></li>
<li><p>Join geodataframes with attribute tables</p></li>
<li><p>Plot maps in multiple ways</p></li>
<li><p>Get some knowledge about clustering (will talk about it next week!)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ## Let&#39;s install and then load libraries</span>
<span class="c1"># %pip install geopandas</span>
<span class="c1"># %pip install mapclassify</span>
<span class="c1"># %pip install contextily</span>
<span class="c1"># %pip install libpysal</span>
<span class="c1"># %pip install esda</span>
<span class="c1"># %pip install splot</span>
<span class="c1"># %pip install xlrd</span>
<span class="c1"># %pip install numba==0.53</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s start with importing the packages</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">mapclassify</span>
<span class="kn">import</span> <span class="nn">esda</span>
<span class="kn">import</span> <span class="nn">splot</span>
<span class="kn">import</span> <span class="nn">libpysal</span> <span class="k">as</span> <span class="nn">lps</span>
<span class="kn">import</span> <span class="nn">contextily</span> <span class="k">as</span> <span class="nn">cx</span>
<span class="kn">import</span> <span class="nn">xlrd</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="a-review-of-spatial-data-and-mapping">
<h1>A review of spatial data and mapping<a class="headerlink" href="#a-review-of-spatial-data-and-mapping" title="Link to this heading">#</a></h1>
<section id="let-s-bring-in-the-same-files-we-worked-with-last-week">
<h2>Let’s bring in the same files we worked with last week<a class="headerlink" href="#let-s-bring-in-the-same-files-we-worked-with-last-week" title="Link to this heading">#</a></h2>
<p>We’ll be working with the Toronto Neighbourhoods spatial data and the health data today:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Toronto_Neighbourhoods.geojson</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1_ahd_neighb_db_ast_hbp_mhv_copd_2007.xls</span></code></p></li>
</ul>
</section>
<section id="using-geopandas-to-load-in-spatial-data">
<h2>1. Using GeoPandas to load in spatial data<a class="headerlink" href="#using-geopandas-to-load-in-spatial-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrhd</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;Toronto_Neighbourhoods.geojson&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The content of the spatial data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrhd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AREA_ATTR_ID</th>
      <th>AREA_DESC</th>
      <th>AREA_ID</th>
      <th>AREA_LONG_CODE</th>
      <th>AREA_NAME</th>
      <th>AREA_SHORT_CODE</th>
      <th>CLASSIFICATION</th>
      <th>CLASSIFICATION_CODE</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>OBJECTID</th>
      <th>PARENT_AREA_ID</th>
      <th>Shape__Area</th>
      <th>Shape__Length</th>
      <th>X</th>
      <th>Y</th>
      <th>_id</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26005521</td>
      <td>Casa Loma (96)</td>
      <td>2480141</td>
      <td>096</td>
      <td>Casa Loma (96)</td>
      <td>096</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>17545105</td>
      <td>None</td>
      <td>3.678385e+06</td>
      <td>8214.176485</td>
      <td>None</td>
      <td>None</td>
      <td>1</td>
      <td>POLYGON ((-79.41469 43.67391, -79.41485 43.674...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26005520</td>
      <td>Annex (95)</td>
      <td>2480140</td>
      <td>095</td>
      <td>Annex (95)</td>
      <td>095</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>17545121</td>
      <td>None</td>
      <td>5.337192e+06</td>
      <td>10513.883143</td>
      <td>None</td>
      <td>None</td>
      <td>2</td>
      <td>POLYGON ((-79.39414 43.66872, -79.39588 43.668...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What is geometry?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_neighbor</span> <span class="o">=</span> <span class="n">nbrhd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first_neighbor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>POLYGON ((-79.41469317817781 43.6739104164259, -79.41484930122832 43.6743388247927, -79.4155279126094 43.67606998537741, -79.4157867581137 43.6767302521386, -79.4164385645546 43.6783329020511, -79.4165782543862 43.6787785512344, -79.4167583944682 43.6792484522149, -79.41698203537291 43.6798247440047, -79.4170902471251 43.6801047004014, -79.4174797570886 43.681051830379, -79.4176666295158 43.6815699096212, -79.4176976020857 43.68163169892501, -79.4178116560388 43.6819252777403, -79.4181213711598 43.6827105222857, -79.4182734938897 43.6830961662335, -79.418301440907 43.683167503583, -79.4184313411692 43.6834966841996, -79.4184870757371 43.6836294842548, -79.4185410795905 43.6837582054538, -79.4184092922561 43.683786393574, -79.4182955283344 43.6834937157887, -79.4154265333151 43.684065660547, -79.4135200432832 43.6844456915062, -79.4134087861596 43.6844695957643, -79.4134686959176 43.6846245536214, -79.4124643275333 43.6848288476745, -79.4118960009694 43.6849418545125, -79.4126020656339 43.6866857692443, -79.4128218223812 43.687229039671, -79.4122731860895 43.687340632143, -79.4123095851789 43.6874306640936, -79.4124449310775 43.6877690817767, -79.4125749764611 43.6881026705283, -79.4126022442033 43.68820308289101, -79.4126262355444 43.6883388768546, -79.412631283351 43.6884334123732, -79.4126432068819 43.6885168725437, -79.4126690850027 43.6886690142942, -79.4121798023448 43.6887725684515, -79.4121317450359 43.688782747996, -79.4094911620232 43.6893416576956, -79.4095159141932 43.6894373160946, -79.4079543147094 43.6897847976179, -79.4064026019847 43.6900806794424, -79.4048987011668 43.6903958607535, -79.4030176369546 43.6907821281771, -79.4030622386805 43.6907397518989, -79.403084589916 43.6906872662864, -79.4030847025454 43.6906327275232, -79.40233853963132 43.6887211977866, -79.4014954899744 43.6866406966408, -79.401126389152 43.6857160700657, -79.400841057476 43.6850272500519, -79.4005303647662 43.6843098010236, -79.4002092949982 43.6835267044631, -79.4001688947727 43.6834159800984, -79.3998035302044 43.6825434875815, -79.3992154226597 43.6811276314469, -79.3990654446524 43.6807665464922, -79.3989394746847 43.6804604265612, -79.3987331620365 43.679962228305, -79.3985629657772 43.6795542728627, -79.3983515160598 43.6790391648102, -79.3981409020124 43.6785307360415, -79.3980121612171 43.6782038734666, -79.3979440512351 43.6780262977103, -79.3979313672526 43.6779949618024, -79.397997906573 43.6779648847871, -79.39810766305662 43.6779154844303, -79.3982178162304 43.677866084320804, -79.3983283660932 43.677816684457504, -79.3984396598895 43.6777672941492, -79.3985509707706 43.677722377402, -79.39866305797811 43.6776729695768, -79.3987751498381 43.6776280623042, -79.39888799806091 43.677583155590305, -79.3990012429834 43.6775382491152, -79.399114879728 43.6774888512157, -79.3992025285702 43.6774574239244, -79.3992901799736 43.6774169952501, -79.3993786050701 43.6773810678483, -79.3994674269127 43.677345149728104, -79.3995566132194 43.6773137235166, -79.3996462037999 43.6772777969312, -79.3997357818565 43.6772418792657, -79.3998261336784 43.6772104448643, -79.3999168946437 43.6771790287522, -79.4000076183382 43.6771475945326, -79.4000991356532 43.6771161699357, -79.4001906603179 43.6770802536138, -79.4002825618979 43.6770488292052, -79.4003752372778 43.6770218970549, -79.40046791256 43.6769949738305, -79.4005609796537 43.6769635502124, -79.4006540144064 43.6769366361508, -79.40074786265342 43.6769052040578, -79.4008416959652 43.6768827821947, -79.4009359160751 43.6768513592708, -79.4010305181557 43.6768289379187, -79.4011394914127 43.6767930269395, -79.40124844475712 43.6767616164984, -79.4013577948506 43.6767302062957, -79.4014675168886 43.6766987963088, -79.401577635645 43.6766674045606, -79.4016877469976 43.6766404773541, -79.4017982426678 43.6766135773755, -79.401909142447 43.6765821679758, -79.4020200223858 43.6765552591109, -79.4021313064015 43.6765238498247, -79.4022429725496 43.6765014420761, -79.4023546335109 43.6764745335542, -79.4024666788314 43.6764476252511, -79.4025787240519 43.6764207168379, -79.4026915556349 43.6763983006426, -79.40280397272 43.67637139232491, -79.402883149386 43.6763541860873, -79.4029167917251 43.6763489758964, -79.4030299826882 43.6763265686732, -79.4031435776805 43.6762996520191, -79.4049670168388 43.6759208047062, -79.4073338149418 43.675429007407, -79.407847991862 43.67532218132661, -79.4113608949251 43.6745959152122, -79.4121860970333 43.6744315128604, -79.4137161812489 43.6741115018232, -79.4146748682077 43.6739143093347, -79.41469317817781 43.6739104164259))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_neighbor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/4b938be3a15d781260e818a13824198846d9cccee135ad6a4ec0c600793328ee.svg" src="../../../_images/4b938be3a15d781260e818a13824198846d9cccee135ad6a4ec0c600793328ee.svg" /></div>
</div>
<p>Another example of geometry</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rails</span> <span class="o">=</span>  <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;toronto_rails.geojson&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rails</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MULTILINESTRING ((-79.5125670999999 43.814361500000075, -79.51253669999994 43.81447250000008, -79.512524 43.81452850000005, -79.51251939999992 43.814607, -79.51251739999992 43.814716900000064, -79.51252729999993 43.814817, -79.51254659999995 43.81492840000004, -79.51261019999993 43.815184800000054, -79.51270719999991 43.815575100000046, -79.51291559999993 43.816454400000055, -79.51339439999992 43.81834120000008, -79.51371579999994 43.819633, -79.513803 43.820002, -79.51385459999995 43.82019790000004, -79.51389059999991 43.820318, -79.51392659999993 43.82045130000006))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_rail_points</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mf">79.5125670999999</span><span class="p">,</span><span class="mf">43.814361500000075</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51253669999994</span><span class="p">,</span> <span class="mf">43.81447250000008</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.512524</span><span class="p">,</span> <span class="mf">43.81452850000005</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51251939999992</span><span class="p">,</span><span class="mf">43.814607</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51251739999992</span><span class="p">,</span><span class="mf">43.814716900000064</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51252729999993</span><span class="p">,</span><span class="mf">43.814817</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51254659999995</span><span class="p">,</span><span class="mf">43.81492840000004</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51261019999993</span><span class="p">,</span><span class="mf">43.815184800000054</span><span class="p">),</span>
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51270719999991</span><span class="p">,</span><span class="mf">43.815575100000046</span><span class="p">),</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51291559999993</span><span class="p">,</span><span class="mf">43.816454400000055</span><span class="p">),</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51339439999992</span><span class="p">,</span><span class="mf">43.81834120000008</span><span class="p">),</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51371579999994</span><span class="p">,</span><span class="mf">43.819633</span><span class="p">),</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.513803</span><span class="p">,</span><span class="mf">43.820002</span><span class="p">),</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51385459999995</span><span class="p">,</span> <span class="mf">43.82019790000004</span><span class="p">),</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51389059999991</span><span class="p">,</span> <span class="mf">43.820318</span><span class="p">),</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mf">79.51392659999993</span><span class="p">,</span> <span class="mf">43.82045130000006</span><span class="p">),]</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span> <span class="n">first_rail_points</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-79.5125670999999,
 -79.51253669999994,
 -79.512524,
 -79.51251939999992,
 -79.51251739999992,
 -79.51252729999993,
 -79.51254659999995,
 -79.51261019999993,
 -79.51270719999991,
 -79.51291559999993,
 -79.51339439999992,
 -79.51371579999994,
 -79.513803,
 -79.51385459999995,
 -79.51389059999991,
 -79.51392659999993)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a0d1dc4e28590f6c008d52c65326eabef4198d19561ca58b6a08ab40a9443b7c.png" src="../../../_images/a0d1dc4e28590f6c008d52c65326eabef4198d19561ca58b6a08ab40a9443b7c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rails</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a9c90d2fe5cb7ef219b94d466110604094048a0fabd9c8c04bdfdaae1a96ebfc.svg" src="../../../_images/a9c90d2fe5cb7ef219b94d466110604094048a0fabd9c8c04bdfdaae1a96ebfc.svg" /></div>
</div>
<p>Note: the difference between plotting on Cartesian coordinate system and plotting as a geo-object comes from the different coordination system used by the GeoDataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rails</span><span class="o">.</span><span class="n">crs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Geographic 2D CRS: EPSG:4269&gt;
Name: NAD83
Axis Info [ellipsoidal]:
- Lat[north]: Geodetic latitude (degree)
- Lon[east]: Geodetic longitude (degree)
Area of Use:
- name: North America - onshore and offshore: Canada - Alberta; British Columbia; Manitoba; New Brunswick; Newfoundland and Labrador; Northwest Territories; Nova Scotia; Nunavut; Ontario; Prince Edward Island; Quebec; Saskatchewan; Yukon. Puerto Rico. United States (USA) - Alabama; Alaska; Arizona; Arkansas; California; Colorado; Connecticut; Delaware; Florida; Georgia; Hawaii; Idaho; Illinois; Indiana; Iowa; Kansas; Kentucky; Louisiana; Maine; Maryland; Massachusetts; Michigan; Minnesota; Mississippi; Missouri; Montana; Nebraska; Nevada; New Hampshire; New Jersey; New Mexico; New York; North Carolina; North Dakota; Ohio; Oklahoma; Oregon; Pennsylvania; Rhode Island; South Carolina; South Dakota; Tennessee; Texas; Utah; Vermont; Virginia; Washington; West Virginia; Wisconsin; Wyoming. US Virgin Islands. British Virgin Islands.
- bounds: (167.65, 14.92, -40.73, 86.45)
Datum: North American Datum 1983
- Ellipsoid: GRS 1980
- Prime Meridian: Greenwich
</pre></div>
</div>
</div>
</div>
<p>Therefore, a <code class="docutils literal notranslate"><span class="pre">GeoDataframe</span></code> can be understood as a <code class="docutils literal notranslate"><span class="pre">GeoSeries</span></code> with several <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<p><img alt="figure" src="../../../_images/dataframe.svg" /></p>
</section>
<section id="simplify-the-geodataframe">
<h2>2. Simplify the geodataframe<a class="headerlink" href="#simplify-the-geodataframe" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrhd</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;AREA_ATTR_ID&#39;, &#39;AREA_DESC&#39;, &#39;AREA_ID&#39;, &#39;AREA_LONG_CODE&#39;, &#39;AREA_NAME&#39;,
       &#39;AREA_SHORT_CODE&#39;, &#39;CLASSIFICATION&#39;, &#39;CLASSIFICATION_CODE&#39;, &#39;LATITUDE&#39;,
       &#39;LONGITUDE&#39;, &#39;OBJECTID&#39;, &#39;PARENT_AREA_ID&#39;, &#39;Shape__Area&#39;,
       &#39;Shape__Length&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;_id&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># important columns</span>
<span class="n">important_spat_cols</span> <span class="o">=</span> <span class="n">nbrhd</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">17</span><span class="p">]]</span>
<span class="n">important_spat_cols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;AREA_NAME&#39;, &#39;AREA_SHORT_CODE&#39;, &#39;geometry&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rename dictionary</span>
<span class="n">colnames_spat</span> <span class="o">=</span> <span class="p">{</span><span class="n">important_spat_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
           <span class="n">important_spat_cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;nbrhd_spat_id&#39;</span><span class="p">,</span>
           <span class="n">important_spat_cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;geometry&#39;</span><span class="p">}</span>
<span class="n">colnames_spat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;AREA_NAME&#39;: &#39;name&#39;,
 &#39;AREA_SHORT_CODE&#39;: &#39;nbrhd_spat_id&#39;,
 &#39;geometry&#39;: &#39;geometry&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selec the important columns</span>
<span class="n">nbrhd_simple</span> <span class="o">=</span> <span class="n">nbrhd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">nbrhd_simple</span> <span class="o">=</span> <span class="n">nbrhd_simple</span><span class="p">[</span><span class="n">important_spat_cols</span><span class="p">]</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">colnames_spat</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>nbrhd_spat_id</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Casa Loma (96)</td>
      <td>096</td>
      <td>POLYGON ((-79.41469 43.67391, -79.41485 43.674...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Annex (95)</td>
      <td>095</td>
      <td>POLYGON ((-79.39414 43.66872, -79.39588 43.668...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Caledonia-Fairbank (109)</td>
      <td>109</td>
      <td>POLYGON ((-79.46021 43.68156, -79.46044 43.681...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Woodbine Corridor (64)</td>
      <td>064</td>
      <td>POLYGON ((-79.31485 43.66674, -79.31660 43.666...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lawrence Park South (103)</td>
      <td>103</td>
      <td>POLYGON ((-79.41096 43.70408, -79.41165 43.703...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Convert our spatial ID from a string to a number:</p>
<ul class="simple">
<li><p>rembmer the type of spatial ID in the health dataset is <code class="docutils literal notranslate"><span class="pre">int</span></code> but here in spatial dataset it is <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create a new variable in the nbrhd_simple geodataframe and store the new number</span>
<span class="c1">#version of the neighbourhood id here</span>
<span class="n">nbrhd_simple</span><span class="p">[</span><span class="s2">&quot;Neighbid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbrhd_simple</span><span class="p">[</span><span class="s2">&quot;nbrhd_spat_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>nbrhd_spat_id</th>
      <th>geometry</th>
      <th>Neighbid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Casa Loma (96)</td>
      <td>096</td>
      <td>POLYGON ((-79.41469 43.67391, -79.41485 43.674...</td>
      <td>96</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Annex (95)</td>
      <td>095</td>
      <td>POLYGON ((-79.39414 43.66872, -79.39588 43.668...</td>
      <td>95</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Caledonia-Fairbank (109)</td>
      <td>109</td>
      <td>POLYGON ((-79.46021 43.68156, -79.46044 43.681...</td>
      <td>109</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Woodbine Corridor (64)</td>
      <td>064</td>
      <td>POLYGON ((-79.31485 43.66674, -79.31660 43.666...</td>
      <td>64</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lawrence Park South (103)</td>
      <td>103</td>
      <td>POLYGON ((-79.41096 43.70408, -79.41165 43.703...</td>
      <td>103</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;nbrhd_spat_id&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Neighbid&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;str&#39;&gt;
&lt;class &#39;numpy.int64&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-health-information-and-simplify-it">
<h2>3. Import health information and simplify it<a class="headerlink" href="#import-health-information-and-simplify-it" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;1_ahd_neighb_db_ast_hbp_mhv_copd_2007.xls&#39;</span> <span class="c1">#file name</span>
<span class="n">sname</span> <span class="o">=</span> <span class="s1">&#39;1_ahd_neighb_asthma_2007&#39;</span> <span class="c1">#sheet name in excel file</span>

<span class="c1">#store excel sheet with asthma data in a dataframe variable</span>
<span class="n">asthma_neighb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sname</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asthma_neighb</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 1</th>
      <th>Demographics ª</th>
      <th>% With asthma</th>
      <th>LL (95% CI)</th>
      <th>UL (95% CI)</th>
      <th>Demographics ª.1</th>
      <th>% With asthma.1</th>
      <th>LL (95% CI) .1</th>
      <th>UL (95% CI) .1</th>
      <th>...</th>
      <th>Demographics ª.7</th>
      <th>% With asthma.7</th>
      <th>LL (95% CI) .7</th>
      <th>UL (95% CI) .7</th>
      <th>Demographics ª.8</th>
      <th>% With asthma.8</th>
      <th>LL (95% CI) .8</th>
      <th>UL (95% CI) .8</th>
      <th>Rate Ratio**.2</th>
      <th>H/L/NS.2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>11977</td>
      <td>9.7</td>
      <td>9.2</td>
      <td>10.2</td>
      <td>11770</td>
      <td>10.6</td>
      <td>10.0</td>
      <td>11.2</td>
      <td>...</td>
      <td>4435</td>
      <td>12.3</td>
      <td>11.3</td>
      <td>13.3</td>
      <td>8921</td>
      <td>10.9</td>
      <td>10.3</td>
      <td>11.6</td>
      <td>1.07</td>
      <td>H</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>11157</td>
      <td>7.9</td>
      <td>7.4</td>
      <td>8.4</td>
      <td>11462</td>
      <td>10.2</td>
      <td>9.6</td>
      <td>10.8</td>
      <td>...</td>
      <td>3819</td>
      <td>13.5</td>
      <td>12.5</td>
      <td>14.6</td>
      <td>7726</td>
      <td>11.2</td>
      <td>10.5</td>
      <td>11.9</td>
      <td>1.10</td>
      <td>H</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 44 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asthma_neighb</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Unnamed: 0&#39;, &#39;Unnamed: 1&#39;, &#39;Demographics ª&#39;, &#39;% With asthma&#39;,
       &#39;LL (95% CI) &#39;, &#39;UL (95% CI) &#39;, &#39;Demographics ª.1&#39;, &#39;% With asthma.1&#39;,
       &#39;LL (95% CI) .1&#39;, &#39;UL (95% CI) .1&#39;, &#39;Demographics ª.2&#39;,
       &#39;% With asthma.2&#39;, &#39;LL (95% CI) .2&#39;, &#39;UL (95% CI) .2&#39;, &#39;Rate Ratio**&#39;,
       &#39;H/L/NS&#39;, &#39;Demographics ª.3&#39;, &#39;% With asthma.3&#39;, &#39;LL (95% CI) .3&#39;,
       &#39;UL (95% CI) .3&#39;, &#39;Demographics ª.4&#39;, &#39;% With asthma.4&#39;,
       &#39;LL (95% CI) .4&#39;, &#39;UL (95% CI) .4&#39;, &#39;Demographics ª.5&#39;,
       &#39;% With asthma.5&#39;, &#39;LL (95% CI) .5&#39;, &#39;UL (95% CI) .5&#39;, &#39;Rate Ratio**.1&#39;,
       &#39;H/L/NS.1&#39;, &#39;Demographics ª.6&#39;, &#39;% With asthma.6&#39;, &#39;LL (95% CI) .6&#39;,
       &#39;UL (95% CI) .6&#39;, &#39;Demographics ª.7&#39;, &#39;% With asthma.7&#39;,
       &#39;LL (95% CI) .7&#39;, &#39;UL (95% CI) .7&#39;, &#39;Demographics ª.8&#39;,
       &#39;% With asthma.8&#39;, &#39;LL (95% CI) .8&#39;, &#39;UL (95% CI) .8&#39;, &#39;Rate Ratio**.2&#39;,
       &#39;H/L/NS.2&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># important columns</span>
<span class="c1">## Note: Instead of copying the column names, we can use the number to avoid any miscopies.</span>
<span class="n">important_cols</span> <span class="o">=</span> <span class="n">asthma_neighb</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]]</span> 

<span class="c1"># rename dictionary</span>
<span class="n">colnames</span> <span class="o">=</span> <span class="p">{</span><span class="n">important_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;Neighbid&#39;</span><span class="p">,</span> 
            <span class="n">important_cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> 
            <span class="n">important_cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;adult_pop&#39;</span><span class="p">,</span>
            <span class="n">important_cols</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span> <span class="s1">&#39;asthma_pct&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select important columns</span>
<span class="n">asthma_rates</span> <span class="o">=</span> <span class="n">asthma_neighb</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">asthma_rates</span> <span class="o">=</span> <span class="n">asthma_rates</span><span class="p">[</span><span class="n">important_cols</span><span class="p">]</span>

<span class="n">asthma_rates</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">asthma_rates</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Neighbid</th>
      <th>name</th>
      <th>adult_pop</th>
      <th>asthma_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>23747</td>
      <td>10.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>22619</td>
      <td>9.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>6629</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>6755</td>
      <td>11.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>6588</td>
      <td>11.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="join-our-neighbourhood-gdf-with-our-asthma-rate-df">
<h2>4. Join our neighbourhood gdf with our asthma rate df:<a class="headerlink" href="#join-our-neighbourhood-gdf-with-our-asthma-rate-df" title="Link to this heading">#</a></h2>
<p>Take a look at both data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asthma_rates</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Neighbid</th>
      <th>name</th>
      <th>adult_pop</th>
      <th>asthma_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>23747</td>
      <td>10.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>22619</td>
      <td>9.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>6629</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>6755</td>
      <td>11.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>6588</td>
      <td>11.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For the spatial data, we sort it by neighborhood id to check the consistency</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Neighbid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>nbrhd_spat_id</th>
      <th>geometry</th>
      <th>Neighbid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>30</th>
      <td>West Humber-Clairville (1)</td>
      <td>001</td>
      <td>POLYGON ((-79.55236 43.70947, -79.55238 43.709...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Mount Olive-Silverstone-Jamestown (2)</td>
      <td>002</td>
      <td>POLYGON ((-79.60338 43.75786, -79.60205 43.758...</td>
      <td>2</td>
    </tr>
    <tr>
      <th>124</th>
      <td>Thistletown-Beaumond Heights (3)</td>
      <td>003</td>
      <td>POLYGON ((-79.57751 43.73384, -79.57806 43.734...</td>
      <td>3</td>
    </tr>
    <tr>
      <th>122</th>
      <td>Rexdale-Kipling (4)</td>
      <td>004</td>
      <td>POLYGON ((-79.55512 43.71510, -79.55504 43.714...</td>
      <td>4</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Elms-Old Rexdale (5)</td>
      <td>005</td>
      <td>POLYGON ((-79.55512 43.71510, -79.55569 43.716...</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrhd_simple</span> <span class="o">=</span> <span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">asthma_rates</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Neighbid&quot;</span><span class="p">)</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name_x</th>
      <th>nbrhd_spat_id</th>
      <th>geometry</th>
      <th>Neighbid</th>
      <th>name_y</th>
      <th>adult_pop</th>
      <th>asthma_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Casa Loma (96)</td>
      <td>096</td>
      <td>POLYGON ((-79.41469 43.67391, -79.41485 43.674...</td>
      <td>96</td>
      <td>Casa Loma</td>
      <td>6640</td>
      <td>10.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Annex (95)</td>
      <td>095</td>
      <td>POLYGON ((-79.39414 43.66872, -79.39588 43.668...</td>
      <td>95</td>
      <td>Annex</td>
      <td>20869</td>
      <td>9.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Caledonia-Fairbank (109)</td>
      <td>109</td>
      <td>POLYGON ((-79.46021 43.68156, -79.46044 43.681...</td>
      <td>109</td>
      <td>Caledonia-Fairbank</td>
      <td>6615</td>
      <td>11.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Woodbine Corridor (64)</td>
      <td>064</td>
      <td>POLYGON ((-79.31485 43.66674, -79.31660 43.666...</td>
      <td>64</td>
      <td>Woodbine Corridor</td>
      <td>8346</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lawrence Park South (103)</td>
      <td>103</td>
      <td>POLYGON ((-79.41096 43.70408, -79.41165 43.703...</td>
      <td>103</td>
      <td>Lawrence Park South</td>
      <td>9709</td>
      <td>10.7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="map-the-attribute-data-asthma">
<h2>5. Map the attribute data (asthma)<a class="headerlink" href="#map-the-attribute-data-asthma" title="Link to this heading">#</a></h2>
<p>We need to first set the “stage” of the figure.</p>
<p>Then we plot:</p>
<ul class="simple">
<li><p>the asthma rate (<code class="docutils literal notranslate"><span class="pre">column</span></code> = “asthma_pct”),</p></li>
<li><p>in 5 quantiles (<code class="docutils literal notranslate"><span class="pre">scheme</span></code> = “quantiles”, <code class="docutils literal notranslate"><span class="pre">k</span></code>=5),</p></li>
<li><p>in the stage (<code class="docutils literal notranslate"><span class="pre">ax</span></code> = axes),</p></li>
<li><p>with legend (<code class="docutils literal notranslate"><span class="pre">legend</span></code> = True).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, let&#39;s create a figure variable &quot;fig&quot; and an axes variables called &quot;ax&quot;.</span>
<span class="c1"># This code sets the stage - it says how many images - by rows/columns</span>
<span class="c1"># We can also set other figure attributes in here, like figure size using figsize</span>

<span class="c1">#import matplotlib.pyplot as plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="c1"># Then plot the data with certain arguements:</span>
<span class="c1"># These two codes need to write in the same code, i.e., run simultaneously</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;asthma_pct&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;quantiles&#39;</span><span class="p">,</span> 
                  <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGn&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> 
                  <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                  <span class="n">legend_kwds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Asthmatic&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;title_fontsize&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../../_images/937fcc55d551b8999d7b4dfcb267aa26eca65a608967b1defc82d9da2c481682.png" src="../../../_images/937fcc55d551b8999d7b4dfcb267aa26eca65a608967b1defc82d9da2c481682.png" />
</div>
</div>
<p>Make a figure with two maps side by side…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="c1"># pick the first cell in the figure</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;name_x&quot;</span><span class="p">,</span>
           <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;tab20&quot;</span><span class="p">)</span>

<span class="c1"># pick the second cell in the figure</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;asthma_pct&quot;</span><span class="p">,</span>
           <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;YlGn&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../../_images/bc204ce5d8c37e9351668aaee0c6e8beece6f12642d8c491011042d73ad51e56.png" src="../../../_images/bc204ce5d8c37e9351668aaee0c6e8beece6f12642d8c491011042d73ad51e56.png" />
</div>
</div>
</section>
<section id="pop-quiz">
<h2>POP QUIZ!!<a class="headerlink" href="#pop-quiz" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>How would we make a figure with 3 maps in 1 row?</p></li>
<li><p>How would we make a figure with 3 maps in 1 <strong>column</strong>?</p></li>
<li><p>How would we make a figure with 6 maps in 3 rows and 2 columns?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3 maps in 1 row</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../../_images/abda9ae5877dfbedbb6182ae8bcb9f45e046cf544b83179d107acd0558594fac.png" src="../../../_images/abda9ae5877dfbedbb6182ae8bcb9f45e046cf544b83179d107acd0558594fac.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3 maps in 1 column</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../../_images/3f1d230d7c3cbc38756647d1a9a5a674f56d21b2f9ca4133b7dc4ed0d8e07939.png" src="../../../_images/3f1d230d7c3cbc38756647d1a9a5a674f56d21b2f9ca4133b7dc4ed0d8e07939.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 6 maps in 3 rows and 2 columns</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../../_images/004e70f6cbf4364638ab56e3ac0acc090e17ff2038d9ab84592a9a24f455420e.png" src="../../../_images/004e70f6cbf4364638ab56e3ac0acc090e17ff2038d9ab84592a9a24f455420e.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="more-on-cartography">
<h1>More on Cartography<a class="headerlink" href="#more-on-cartography" title="Link to this heading">#</a></h1>
<section id="to-this-point-we-have-used-quantiles-to-classify-continous-values-in-maps">
<h2>To this point we have used quantiles to classify continous values in maps.<a class="headerlink" href="#to-this-point-we-have-used-quantiles-to-classify-continous-values-in-maps" title="Link to this heading">#</a></h2>
<section id="what-other-common-options-do-we-have-see-the-document-of-geodataframe-plot-and-mapclassify">
<h3>What other common options do we have?  See the document of <a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoDataFrame.plot.html">GeoDataFrame.plot</a> and <a class="reference external" href="https://github.com/pysal/mapclassify/tree/main">mapclassify</a><a class="headerlink" href="#what-other-common-options-do-we-have-see-the-document-of-geodataframe-plot-and-mapclassify" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Equal Intervals</p></li>
</ol>
<ul class="simple">
<li><p>This classification method “divides the data into equal size classes (e.g., 0-10, 10-20, 20-30, etc.) and works best on data that is generally spread across the entire range. <strong>CAUTION</strong>: Avoid equal interval if your data are skewed to one end or if you have one or two really large outlier values.”</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Natural Breaks</p></li>
</ol>
<ul class="simple">
<li><p>This classification method “is a kind of “optimal” classification scheme that finds class breaks that will minimize within-class variance and maximize between-class differences.” <strong>However</strong>, these breaks will be unique to each dataset and makes it difficult to compare across different maps.</p></li>
</ul>
<p>Before plot the variable, we usually want to see its distribution to see if certain classification can fit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">asthma_pct</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../../_images/abf76421b548f121ac6f5f6d7c6dc8105a3820fd3e5799fc04f4846162151b93.png" src="../../../_images/abf76421b548f121ac6f5f6d7c6dc8105a3820fd3e5799fc04f4846162151b93.png" />
</div>
</div>
<p>Close to normal distribution, which means that the equal intervals should be fine.</p>
<p>Let’s use the <code class="docutils literal notranslate"><span class="pre">scheme</span></code> parameter to the plot our asthma percentages using quartiles, equal intervals, and natural breaks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;asthma_pct&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> 
                  <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                  <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                  
                  <span class="n">legend_kwds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Asthmatic&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;title_fontsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>

<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;asthma_pct&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;EqualInterval&#39;</span><span class="p">,</span> 
                  <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                  <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                  
                  <span class="n">legend_kwds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Asthmatic&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;title_fontsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>

<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;asthma_pct&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;NaturalBreaks&#39;</span><span class="p">,</span> 
                  <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                  <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                  
                  <span class="n">legend_kwds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Asthmatic&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;title_fontsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Quartiles&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Equal Intervals&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Natural Breaks&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">current_fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span> <span class="c1">#get current figure aka gcf</span>
<span class="n">current_fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;asthma_three_class.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#export maps as an image file!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/f576c9d6158b9f7b22d0967363206b1a67d5c265a3eee08b7eaf2b5f1f9b2781.png" src="../../../_images/f576c9d6158b9f7b22d0967363206b1a67d5c265a3eee08b7eaf2b5f1f9b2781.png" />
</div>
</div>
<p>Another way to show the figure: save it and import it to show in the presentation!
<img alt="figure" src="../../../_images/asthma_three_class.png" /></p>
</section>
</section>
<section id="adding-a-background">
<h2>Adding a background<a class="headerlink" href="#adding-a-background" title="Link to this heading">#</a></h2>
<p>What if we want to add a background to our maps? It’s pretty easy!</p>
<p>We will use the <a class="reference external" href="https://contextily.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">contextily</span></code> library</a> to do this.</p>
<p>But first we need to double check that our coordinate reference system is properly set. To layer our maps on top of a web background map, we need to make sure the projection is set to something known as “Web Mercator”: <a class="reference external" href="https://epsg.io/3857">https://epsg.io/3857</a></p>
<p>That is, make our spatial data have the <em>same</em> coordinate reference system as the web map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#check current crs: WGS 84 (EPSG:4326)</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">crs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Geographic 2D CRS: EPSG:4326&gt;
Name: WGS 84
Axis Info [ellipsoidal]:
- Lat[north]: Geodetic latitude (degree)
- Lon[east]: Geodetic longitude (degree)
Area of Use:
- name: World.
- bounds: (-180.0, -90.0, 180.0, 90.0)
Datum: World Geodetic System 1984 ensemble
- Ellipsoid: WGS 84
- Prime Meridian: Greenwich
</pre></div>
</div>
</div>
</div>
<section id="let-s-reproject-the-map-into-web-mercator-and-compare-to-the-original-projection">
<h3>Let’s reproject the map into Web Mercator and compare to the original projection:<a class="headerlink" href="#let-s-reproject-the-map-into-web-mercator-and-compare-to-the-original-projection" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrhd_webmap</span> <span class="o">=</span> <span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:3857&quot;</span><span class="p">)</span>

<span class="c1">#let&#39;s throw in a polar projection just for fun! </span>
<span class="c1">## https://www.esri.com/arcgis-blog/products/imagery/imagery/two-views-from-the-top-of-the-world/</span>
<span class="n">nbrhd_polar</span> <span class="o">=</span> <span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:3995&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c1">#original</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">#web mercator</span>
<span class="n">nbrhd_webmap</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#polar projection</span>
<span class="n">nbrhd_polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;WGS 84&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Web Mercator&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Polar&#39;)
</pre></div>
</div>
<img alt="../../../_images/60f3fd6f89fe4afaeaeaa0aa7dfa40f34904e4ac33b7c44fb382c6bcbc42c49a.png" src="../../../_images/60f3fd6f89fe4afaeaeaa0aa7dfa40f34904e4ac33b7c44fb382c6bcbc42c49a.png" />
</div>
</div>
<p>Note: The coordinate reference system will change how the geometry is plotted in a 2D map.</p>
</section>
<section id="to-add-the-web-basemap-we-can-do-the-following">
<h3>To add the web basemap, we can do the following<a class="headerlink" href="#to-add-the-web-basemap-we-can-do-the-following" title="Link to this heading">#</a></h3>
<p>Remember we have import the <code class="docutils literal notranslate"><span class="pre">contextily</span></code> package as <code class="docutils literal notranslate"><span class="pre">cx</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c1">#alpha parameter makes the map transparent</span>
<span class="n">nbrhd_webmap</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;asthma_pct&quot;</span><span class="p">,</span> <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
                  <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Reds&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">cx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e20ddc6cf540f9a55e06cb6b0f0e17374ba7d163614612722edfab586f653980.png" src="../../../_images/e20ddc6cf540f9a55e06cb6b0f0e17374ba7d163614612722edfab586f653980.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">contextily</span></code> pacakage also provides different map source.</p>
<p>For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Under</span> <span class="n">the</span> <span class="n">provider</span> <span class="n">of</span> <span class="n">CartoDB</span><span class="p">:</span>
<span class="o">-</span> <span class="n">Positron</span>
<span class="o">-</span> <span class="n">PositronNoLabels</span> 
<span class="o">-</span> <span class="n">PositronOnlyLabels</span> 
<span class="o">-</span> <span class="n">DarkMatter</span> 
<span class="o">-</span> <span class="n">DarkMatterNoLabels</span> 
<span class="o">-</span> <span class="n">DarkMatterOnlyLabels</span> 
<span class="o">-</span> <span class="n">Voyager</span> 
<span class="o">-</span> <span class="n">VoyagerNoLabels</span>
<span class="o">-</span> <span class="n">VoyagerOnlyLabels</span>
<span class="o">-</span> <span class="n">VoyagerLabelsUnder</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c1">#alpha parameter makes the map transparent</span>
<span class="n">nbrhd_webmap</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;asthma_pct&quot;</span><span class="p">,</span> <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
                  <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Reds&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">cx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span>
              <span class="n">source</span><span class="o">=</span><span class="n">cx</span><span class="o">.</span><span class="n">providers</span><span class="o">.</span><span class="n">CartoDB</span><span class="o">.</span><span class="n">DarkMatter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a26622ca3ea058267d28cb509500b51b04f51e69e9499545cf8a253c3edb12e9.png" src="../../../_images/a26622ca3ea058267d28cb509500b51b04f51e69e9499545cf8a253c3edb12e9.png" />
</div>
</div>
</section>
</section>
<section id="what-else-we-can-visualize-the-data-analysis-results-together">
<h2>What else? We can visualize the data analysis results together!<a class="headerlink" href="#what-else-we-can-visualize-the-data-analysis-results-together" title="Link to this heading">#</a></h2>
<p>Recall we’ve conducted a linear regression on the correlation between asthma and immigration.</p>
<p>We can plot the data description, spatial distribution, and linear regression togehter.</p>
<section id="load-in-the-immigration-data">
<h3>1. load in the immigration data<a class="headerlink" href="#load-in-the-immigration-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;1_socdem_neighb_2006-2.xls&#39;</span>
<span class="n">sname</span> <span class="o">=</span> <span class="s1">&#39;socdem_2006&#39;</span>
<span class="n">socdem_neighb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sname</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">socdem_neighb</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Neighbourhood id</th>
      <th>Neighbourhood Name</th>
      <th>Total Population</th>
      <th>% 19 and under</th>
      <th>% 65 and over</th>
      <th>% Living alone</th>
      <th>% Aged 65+ living alone</th>
      <th>% Lone parent families §</th>
      <th>% 1 year mobility in population</th>
      <th>Median household income before-tax $</th>
      <th>...</th>
      <th>% Less than high school education **</th>
      <th>% With a University degree **</th>
      <th>% No knowledge of English/French</th>
      <th>% Recent immigrants-within 5 years</th>
      <th>% Recent immigrants-within 10 years</th>
      <th>% Immigrants</th>
      <th>% Visible minority</th>
      <th>Top 3 Home Languages for non-English speaking households, #1</th>
      <th>Top 3 Home Languages for non-English speaking households, #2</th>
      <th>Top 3 Home Languages for non-English speaking households, #3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>32252</td>
      <td>26.8</td>
      <td>11.3</td>
      <td>3.7</td>
      <td>11.7</td>
      <td>26.3</td>
      <td>11.6</td>
      <td>63413</td>
      <td>...</td>
      <td>18.4</td>
      <td>22.9</td>
      <td>5.4</td>
      <td>12.2</td>
      <td>22.1</td>
      <td>60.0</td>
      <td>77.9</td>
      <td>Panjabi (Punjabi)</td>
      <td>Gujarati</td>
      <td>Spanish</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>32127</td>
      <td>32.2</td>
      <td>8.1</td>
      <td>4.1</td>
      <td>15.4</td>
      <td>31.5</td>
      <td>15.7</td>
      <td>48146</td>
      <td>...</td>
      <td>20.1</td>
      <td>23.6</td>
      <td>7.6</td>
      <td>22.2</td>
      <td>35.1</td>
      <td>67.1</td>
      <td>85.3</td>
      <td>Panjabi (Punjabi)</td>
      <td>Gujarati</td>
      <td>Arabic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>9928</td>
      <td>25.3</td>
      <td>16.7</td>
      <td>5.4</td>
      <td>17.5</td>
      <td>30.1</td>
      <td>10.9</td>
      <td>55032</td>
      <td>...</td>
      <td>16.7</td>
      <td>20.7</td>
      <td>5.0</td>
      <td>9.7</td>
      <td>19.3</td>
      <td>55.9</td>
      <td>53.8</td>
      <td>Panjabi (Punjabi)</td>
      <td>Italian</td>
      <td>Spanish</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>10725</td>
      <td>23.6</td>
      <td>18.3</td>
      <td>10.2</td>
      <td>28.8</td>
      <td>33.3</td>
      <td>13.2</td>
      <td>52428</td>
      <td>...</td>
      <td>15.3</td>
      <td>18.8</td>
      <td>3.0</td>
      <td>8.3</td>
      <td>14.0</td>
      <td>47.2</td>
      <td>41.8</td>
      <td>Spanish</td>
      <td>Panjabi (Punjabi)</td>
      <td>Croatian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>9437</td>
      <td>29.9</td>
      <td>10.5</td>
      <td>5.8</td>
      <td>13.0</td>
      <td>39.1</td>
      <td>9.7</td>
      <td>53779</td>
      <td>...</td>
      <td>15.2</td>
      <td>18.8</td>
      <td>3.6</td>
      <td>9.8</td>
      <td>18.2</td>
      <td>53.8</td>
      <td>60.5</td>
      <td>Spanish</td>
      <td>Italian</td>
      <td>Urdu</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">socdem_neighb</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Neighbourhood id&#39;, &#39;Neighbourhood Name&#39;, &#39;Total Population&#39;,
       &#39;% 19 and under&#39;, &#39;% 65 and over&#39;, &#39;% Living alone&#39;,
       &#39;% Aged 65+ living alone&#39;, &#39;% Lone parent families §&#39;,
       &#39;% 1 year mobility in population&#39;,
       &#39;Median household income before-tax $&#39;,
       &#39;Median household income after-tax $ ‡&#39;,
       &#39;% Families-Incidence of low income before-tax&#39;,
       &#39;% Families-Incidence of low income after-tax ‡&#39;,
       &#39;% Individuals-Incidence of low income before-tax&#39;,
       &#39;% Individuals-Incidence of low income after-tax ‡&#39;,
       &#39;% Rented Dwellings&#39;, &#39;% Unemployment rate *&#39;,
       &#39;% Not in labour force *&#39;, &#39;% Less than high school education **&#39;,
       &#39;% With a University degree **&#39;, &#39;% No knowledge of English/French&#39;,
       &#39;% Recent immigrants-within 5 years&#39;,
       &#39;% Recent immigrants-within 10 years&#39;, &#39;% Immigrants&#39;,
       &#39;% Visible minority&#39;,
       &#39;Top 3 Home Languages for non-English speaking households, #1&#39;,
       &#39;Top 3 Home Languages for non-English speaking households, #2&#39;,
       &#39;Top 3 Home Languages for non-English speaking households, #3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Important columns</span>
<span class="n">important_cols</span> <span class="o">=</span> <span class="n">socdem_neighb</span><span class="o">.</span><span class="n">columns</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">21</span><span class="p">]]</span>

<span class="n">rename_dic</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">important_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="s1">&#39;Neighbid&#39;</span><span class="p">,</span>
    <span class="n">important_cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
    <span class="n">important_cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="s1">&#39;median_income&#39;</span><span class="p">,</span>
    <span class="n">important_cols</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="s1">&#39;immigration5&#39;</span>
<span class="p">}</span>
<span class="n">rename_dic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Neighbourhood id&#39;: &#39;Neighbid&#39;,
 &#39;Neighbourhood Name&#39;: &#39;name&#39;,
 &#39;Median household income after-tax $ ‡&#39;: &#39;median_income&#39;,
 &#39;% Recent immigrants-within 5 years&#39;: &#39;immigration5&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select important columns</span>
<span class="n">socdem_neighb</span> <span class="o">=</span> <span class="n">socdem_neighb</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">socdem_neighb</span> <span class="o">=</span> <span class="n">socdem_neighb</span><span class="p">[</span><span class="n">important_cols</span><span class="p">]</span>
<span class="n">socdem_neighb</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">rename_dic</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">socdem_neighb</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Neighbid</th>
      <th>name</th>
      <th>median_income</th>
      <th>immigration5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>West Humber-Clairville</td>
      <td>56220</td>
      <td>12.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mount Olive-Silverstone-Jamestown</td>
      <td>43975</td>
      <td>22.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Thistletown-Beaumond Heights</td>
      <td>49800</td>
      <td>9.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Rexdale-Kipling</td>
      <td>46033</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Elms-Old Rexdale</td>
      <td>48055</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="merge-dataset">
<h3>2. Merge dataset<a class="headerlink" href="#merge-dataset" title="Link to this heading">#</a></h3>
<p>Merge <code class="docutils literal notranslate"><span class="pre">socdem_neighb</span></code> to <code class="docutils literal notranslate"><span class="pre">nbrhd_webmap</span></code>, because we want to map it on a basemap.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrhd_webmap</span> <span class="o">=</span> <span class="n">nbrhd_webmap</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">socdem_neighb</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Neighbid&#39;</span><span class="p">)</span>

<span class="n">nbrhd_webmap</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name_x</th>
      <th>nbrhd_spat_id</th>
      <th>geometry</th>
      <th>Neighbid</th>
      <th>name_y</th>
      <th>adult_pop</th>
      <th>asthma_pct</th>
      <th>name</th>
      <th>median_income</th>
      <th>immigration5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Casa Loma (96)</td>
      <td>096</td>
      <td>POLYGON ((-8840403.206 5415116.967, -8840420.5...</td>
      <td>96</td>
      <td>Casa Loma</td>
      <td>6640</td>
      <td>10.1</td>
      <td>Casa Loma</td>
      <td>59151</td>
      <td>4.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Annex (95)</td>
      <td>095</td>
      <td>POLYGON ((-8838115.394 5414318.191, -8838308.4...</td>
      <td>95</td>
      <td>Annex</td>
      <td>20869</td>
      <td>9.5</td>
      <td>Annex</td>
      <td>46012</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Caledonia-Fairbank (109)</td>
      <td>109</td>
      <td>POLYGON ((-8845470.121 5416294.143, -8845495.7...</td>
      <td>109</td>
      <td>Caledonia-Fairbank</td>
      <td>6615</td>
      <td>11.3</td>
      <td>Caledonia-Fairbank</td>
      <td>46712</td>
      <td>7.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Woodbine Corridor (64)</td>
      <td>064</td>
      <td>POLYGON ((-8829288.812 5414013.407, -8829483.7...</td>
      <td>64</td>
      <td>Woodbine Corridor</td>
      <td>8346</td>
      <td>13.0</td>
      <td>Woodbine Corridor</td>
      <td>49287</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lawrence Park South (103)</td>
      <td>103</td>
      <td>POLYGON ((-8839987.390 5419761.937, -8840063.9...</td>
      <td>103</td>
      <td>Lawrence Park South</td>
      <td>9709</td>
      <td>10.7</td>
      <td>Lawrence Park South</td>
      <td>99440</td>
      <td>2.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="conduct-linear-regression">
<h3>3. conduct linear regression<a class="headerlink" href="#conduct-linear-regression" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="n">reg_asthmaimm</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;asthma_pct ~ immigration5&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">nbrhd_webmap</span><span class="p">)</span> <span class="c1"># setup the model</span>
<span class="n">reg_asthmaimm_fit</span> <span class="o">=</span> <span class="n">reg_asthmaimm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">reg_asthmaimm_sum</span> <span class="o">=</span> <span class="n">reg_asthmaimm_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">reg_asthmaimm_sum</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>    <td>   11.8266</td> <td>    0.218</td> <td>   54.328</td> <td> 0.000</td> <td>   11.396</td> <td>   12.257</td>
</tr>
<tr>
  <th>immigration5</th> <td>   -0.1597</td> <td>    0.019</td> <td>   -8.475</td> <td> 0.000</td> <td>   -0.197</td> <td>   -0.122</td>
</tr>
</table></div></div>
</div>
</section>
<section id="visualize-the-results">
<h3>4. Visualize the results<a class="headerlink" href="#visualize-the-results" title="Link to this heading">#</a></h3>
<p>The regression analysis shows a significant coefficient of immigration percent, indicating a significant linear relationship.</p>
<p>Therefore, we can visualize these two variables as a scatter plot and regressed line.</p>
<p>What else do we want?</p>
<ul class="simple">
<li><p>data description of the dependent variable</p></li>
<li><p>map both variables</p></li>
</ul>
<p>Then we can plot the four figures in a (2,2) manner.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>

<span class="c1"># Description of the dependent variable</span>
<span class="n">nbrhd_simple</span><span class="o">.</span><span class="n">asthma_pct</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Regression</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;asthma_pct&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;immigration5&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">nbrhd_webmap</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>


<span class="c1"># Map of the dependent variable</span>
<span class="n">nbrhd_webmap</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;asthma_pct&quot;</span><span class="p">,</span> <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
                  <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Reds&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="n">legend_kwds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Asthmatic&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;title_fontsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
<span class="n">cx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Map of the independent variable</span>
<span class="n">nbrhd_webmap</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;immigration5&quot;</span><span class="p">,</span> <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
                  <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="n">legend_kwds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Immigration rate&#39;</span><span class="p">,</span> 
                               <span class="s1">&#39;title_fontsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
<span class="n">cx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Make some adjustment</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Historgram of asthma percentage&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="s1">&#39;Asthma percentage %&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="s1">&#39;Proportion %&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Regression of asthma percentage on immigration rate&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="s1">&#39;Immigration rate recent 5 years %&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_text</span><span class="p">(</span><span class="s1">&#39;Asthma percentage %&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Asthma percentage in Toronto&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Immigration rate recent 5 years in Toronto&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>


<span class="n">current_fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span> 
<span class="n">current_fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;results.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#export maps as an image file!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/3f46c5a3a446c5afa08cc749a0eeabb17ea38bba4497e588a334ad1a9a1ef4e1.png" src="../../../_images/3f46c5a3a446c5afa08cc749a0eeabb17ea38bba4497e588a334ad1a9a1ef4e1.png" />
</div>
</div>
<p><img alt="results" src="../../../_images/results.png" /></p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction-to-clustering">
<h1>Introduction to clustering<a class="headerlink" href="#introduction-to-clustering" title="Link to this heading">#</a></h1>
<section id="what-is-clustering">
<h2>What is clustering?<a class="headerlink" href="#what-is-clustering" title="Link to this heading">#</a></h2>
<p>Clustering, generally, is the act of grouping similar things with eachother.</p>
<p>We can do this with non-spatial data as well as spatial data.</p>
<p>One common clustering method is k-means, which we won’t cover in this class, but if you’re interested, there’s a nice tutorial on the method here:</p>
<p><a class="reference external" href="https://towardsdatascience.com/machine-learning-algorithms-part-9-k-means-example-in-python-f2ad05ed5203">https://towardsdatascience.com/machine-learning-algorithms-part-9-k-means-example-in-python-f2ad05ed5203</a></p>
</section>
<section id="why-do-we-want-to-identify-clusters">
<h2>Why do we want to identify clusters?<a class="headerlink" href="#why-do-we-want-to-identify-clusters" title="Link to this heading">#</a></h2>
<p>Because clusters identify groups of data with similar attribute values, we can use it to begin to understand what <strong>drives</strong> the grouping.</p>
<p>For example, we may have data on individuals’ income outcomes and education levels (e.g., total number of years in schools, colleges, and universities).</p>
<p>If we perform a cluster analysis, we can identify discrete groups which may be easier to work with when we want to do further analysis.</p>
<p>These groups may be something like:</p>
<ul class="simple">
<li><p>cluster 1: high income, more education</p></li>
<li><p>cluster 2: high income, less education</p></li>
<li><p>cluster 3: low income, less education</p></li>
<li><p>cluster 4: low income, more education</p></li>
</ul>
<p>From there, we can look at other attributes of those clusters.</p>
<p>This approach is commonly used in demographic analysis where many attributes are considered to create discrete clusters.</p>
<p>A good example of this used in practice is Environics Analytics PRIZM Segmentation:</p>
<p><a class="reference external" href="https://environicsanalytics.com/en-ca/data/segmentation">https://environicsanalytics.com/en-ca/data/segmentation</a></p>
<p><img alt="example of different segments" src="https://environicsanalytics.com/images/default-source/product-pages/page-content/prizm-page-illustrations-cards.png" /></p>
<p><a class="reference external" href="https://prizm.environicsanalytics.com/?_ga=2.84764121.114697395.1648300904-78433696.1648300904">You can look up what ‘demographic segment’ or cluster your postal code belongs to here!</a></p>
<section id="spatial-clustering-at-a-high-level-is-doing-the-same-thing-but-one-attribute-to-consider-is-geography">
<h3>Spatial clustering, at a high level, is doing the same thing but one attribute to consider is geography.<a class="headerlink" href="#spatial-clustering-at-a-high-level-is-doing-the-same-thing-but-one-attribute-to-consider-is-geography" title="Link to this heading">#</a></h3>
<p>Spatial clustering involves looking at:</p>
<ul class="simple">
<li><p>how some attribute is expressed across space;</p></li>
<li><p>whether similar attribute values are near each other.</p></li>
</ul>
<section id="if-we-want-to-do-spatial-clustering-of-a-variable-what-two-pieces-of-information-do-we-need-don-t-over-think">
<h4>If we want to do ‘spatial clustering’ of a variable what two pieces of information do we need? (don’t over think!!!)<a class="headerlink" href="#if-we-want-to-do-spatial-clustering-of-a-variable-what-two-pieces-of-information-do-we-need-don-t-over-think" title="Link to this heading">#</a></h4>
</section>
</section>
</section>
<section id="autocorrelation">
<h2>Autocorrelation<a class="headerlink" href="#autocorrelation" title="Link to this heading">#</a></h2>
<p>Autocorrelation literally means ‘self correlations’.</p>
<p>So instead of looking at how two attributes relate to each other (e.g., regression), we want to explore one a single attribute relates to its neighbours.</p>
<p>Typically, we’re talking about temporal autocorrelation or spatial autocorrelation.</p>
</section>
<section id="spatial-autocorrelation">
<h2>Spatial Autocorrelation<a class="headerlink" href="#spatial-autocorrelation" title="Link to this heading">#</a></h2>
<p>How does a variable value in a specific location correlate with the variable values in its neighbours?</p>
<ul class="simple">
<li><p>regress a value on the values of its neighbours!</p></li>
</ul>
<section id="so-again-information-do-we-need-to-do-answer-this-question">
<h3>So again, information do we need to do answer this question?<a class="headerlink" href="#so-again-information-do-we-need-to-do-answer-this-question" title="Link to this heading">#</a></h3>
</section>
<section id="for-each-observation-in-this-case-neighborhood-we-need-to-know-their-neighbours">
<h3>1) For each observation (in this case, neighborhood) we need to know their neighbours!<a class="headerlink" href="#for-each-observation-in-this-case-neighborhood-we-need-to-know-their-neighbours" title="Link to this heading">#</a></h3>
<p>To do this we can create something known as a ‘weights matrix’.</p>
<p>A weights matrix is a matrix that describes whether or not any one observation is ‘neighbours’ with another.</p>
<p>There are many ways we can do this, but let’s focus on two common ones: queens contiguity matrix and the rook contiguity matrix:</p>
<p><img alt="weights matrices" src="https://i.stack.imgur.com/CWIHi.jpg" /></p>
</section>
<section id="next-we-need-to-describe-the-value-of-our-attribute-of-interest-in-neighbours">
<h3>2) Next we need to describe the value of our attribute of interest in neighbours<a class="headerlink" href="#next-we-need-to-describe-the-value-of-our-attribute-of-interest-in-neighbours" title="Link to this heading">#</a></h3>
<p>To do this we create a variable known as ‘spatial lag’.</p>
<p>Spatial lag for neighbourhood <em>i</em> is often just the average of some attribute value across all of neighbourhood <em>i</em>’s neighbours (as determined by our weights matrix!).</p>
</section>
<section id="finally-now-we-can-see-how-a-neighbourhood-s-attribute-compares-to-its-neighbours">
<h3>3) Finally, now we can see how a neighbourhood’s attribute compares to its neighbours.<a class="headerlink" href="#finally-now-we-can-see-how-a-neighbourhood-s-attribute-compares-to-its-neighbours" title="Link to this heading">#</a></h3>
<p>This set up allows us to see if neighbourhood’s with high attribute values are next to other neighbourhoods with high values.</p>
<p>We can then use a number of statistical tests to determine if there are ‘significant’ clusters in our dataset.</p>
</section>
<section id="we-will-talk-about-the-code-to-show-how-this-works-next-week">
<h3>We will talk about the code to show how this works next week.<a class="headerlink" href="#we-will-talk-about-the-code-to-show-how-this-works-next-week" title="Link to this heading">#</a></h3>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./weekly-materials/week11/lecture"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../week10/homework/marking/Homework_10_solution.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Homework 10 : Linear Regression</p>
      </div>
    </a>
    <a class="right-next"
       href="../lab/Lab_11.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">GGR274 Lab 11: Data analysis and result presentation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Class 11</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mar-26-2024">Mar. 26, 2024</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#a-review-of-spatial-data-and-mapping">A review of spatial data and mapping</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-bring-in-the-same-files-we-worked-with-last-week">Let’s bring in the same files we worked with last week</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-geopandas-to-load-in-spatial-data">1. Using GeoPandas to load in spatial data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simplify-the-geodataframe">2. Simplify the geodataframe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-health-information-and-simplify-it">3. Import health information and simplify it</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#join-our-neighbourhood-gdf-with-our-asthma-rate-df">4. Join our neighbourhood gdf with our asthma rate df:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#map-the-attribute-data-asthma">5. Map the attribute data (asthma)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pop-quiz">POP QUIZ!!</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-cartography">More on Cartography</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-this-point-we-have-used-quantiles-to-classify-continous-values-in-maps">To this point we have used quantiles to classify continous values in maps.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-other-common-options-do-we-have-see-the-document-of-geodataframe-plot-and-mapclassify">What other common options do we have?  See the document of GeoDataFrame.plot and mapclassify</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-background">Adding a background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-reproject-the-map-into-web-mercator-and-compare-to-the-original-projection">Let’s reproject the map into Web Mercator and compare to the original projection:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#to-add-the-web-basemap-we-can-do-the-following">To add the web basemap, we can do the following</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-else-we-can-visualize-the-data-analysis-results-together">What else? We can visualize the data analysis results together!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-in-the-immigration-data">1. load in the immigration data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-dataset">2. Merge dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conduct-linear-regression">3. conduct linear regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-results">4. Visualize the results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-clustering">Introduction to clustering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-clustering">What is clustering?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-do-we-want-to-identify-clusters">Why do we want to identify clusters?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-clustering-at-a-high-level-is-doing-the-same-thing-but-one-attribute-to-consider-is-geography">Spatial clustering, at a high level, is doing the same thing but one attribute to consider is geography.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#if-we-want-to-do-spatial-clustering-of-a-variable-what-two-pieces-of-information-do-we-need-don-t-over-think">If we want to do ‘spatial clustering’ of a variable what two pieces of information do we need? (don’t over think!!!)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelation">Autocorrelation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-autocorrelation">Spatial Autocorrelation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#so-again-information-do-we-need-to-do-answer-this-question">So again, information do we need to do answer this question?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-each-observation-in-this-case-neighborhood-we-need-to-know-their-neighbours">1) For each observation (in this case, neighborhood) we need to know their neighbours!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#next-we-need-to-describe-the-value-of-our-attribute-of-interest-in-neighbours">2) Next we need to describe the value of our attribute of interest in neighbours</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finally-now-we-can-see-how-a-neighbourhood-s-attribute-compares-to-its-neighbours">3) Finally, now we can see how a neighbourhood’s attribute compares to its neighbours.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#we-will-talk-about-the-code-to-show-how-this-works-next-week">We will talk about the code to show how this works next week.</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By GGR274 Instructors
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>